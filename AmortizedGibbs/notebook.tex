
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{amortized\_bouncingball}
    
    
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{torch}\PY{n+nn}{.}\PY{n+nn}{nn} \PY{k}{as} \PY{n+nn}{nn}
        \PY{k+kn}{import} \PY{n+nn}{torch}\PY{n+nn}{.}\PY{n+nn}{nn}\PY{n+nn}{.}\PY{n+nn}{functional} \PY{k}{as} \PY{n+nn}{F}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
        \PY{k+kn}{from} \PY{n+nn}{util\PYZus{}data} \PY{k}{import} \PY{o}{*}
        \PY{k+kn}{from} \PY{n+nn}{util\PYZus{}hmm\PYZus{}variational\PYZus{}gibbs} \PY{k}{import} \PY{o}{*}
        \PY{k+kn}{from} \PY{n+nn}{smc} \PY{k}{import} \PY{o}{*}
        \PY{k+kn}{from} \PY{n+nn}{util\PYZus{}plots} \PY{k}{import} \PY{o}{*}
        \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{invwishart}\PY{p}{,} \PY{n}{dirichlet}
        \PY{k+kn}{from} \PY{n+nn}{torch}\PY{n+nn}{.}\PY{n+nn}{distributions}\PY{n+nn}{.}\PY{n+nn}{dirichlet} \PY{k}{import} \PY{n}{Dirichlet}
        \PY{n}{sys}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/home/hao/Research/probtorch/}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k+kn}{from} \PY{n+nn}{probtorch}\PY{n+nn}{.}\PY{n+nn}{util} \PY{k}{import} \PY{n}{expand\PYZus{}inputs}
        \PY{k+kn}{import} \PY{n+nn}{probtorch}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{probtorch:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{probtorch}\PY{o}{.}\PY{n}{\PYZus{}\PYZus{}version\PYZus{}\PYZus{}}\PY{p}{,} 
              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{torch:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{torch}\PY{o}{.}\PY{n}{\PYZus{}\PYZus{}version\PYZus{}\PYZus{}}\PY{p}{,} 
              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cuda:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{torch}\PY{o}{.}\PY{n}{cuda}\PY{o}{.}\PY{n}{is\PYZus{}available}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
probtorch: 0.0+5a2c637 torch: 0.5.0a0+3bb8c5e cuda: True

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{c+c1}{\PYZsh{}\PYZsh{} Dataset parameters}
        \PY{n}{num\PYZus{}series} \PY{o}{=} \PY{l+m+mi}{1}
        \PY{n}{T} \PY{o}{=} \PY{l+m+mi}{50}
        \PY{n}{K} \PY{o}{=} \PY{l+m+mi}{4}
        \PY{n}{D} \PY{o}{=} \PY{l+m+mi}{2}
        \PY{n}{dt} \PY{o}{=} \PY{l+m+mi}{10}
        \PY{n}{Boundary} \PY{o}{=} \PY{l+m+mi}{30}
        \PY{n}{noise\PYZus{}ratio} \PY{o}{=} \PY{l+m+mf}{0.5}
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} Model Parameters}
        \PY{n}{num\PYZus{}particles\PYZus{}rws} \PY{o}{=} \PY{l+m+mi}{50}
        \PY{n}{mcmc\PYZus{}steps} \PY{o}{=} \PY{l+m+mi}{3}
        \PY{n}{num\PYZus{}particles\PYZus{}smc} \PY{o}{=} \PY{l+m+mi}{50}
        \PY{n}{NUM\PYZus{}HIDDEN} \PY{o}{=} \PY{l+m+mi}{128}
        \PY{n}{NUM\PYZus{}LATENTS} \PY{o}{=} \PY{n}{K}\PY{o}{*}\PY{n}{K}
        \PY{n}{NUM\PYZus{}OBS} \PY{o}{=} \PY{l+m+mi}{2} \PY{o}{*} \PY{n}{K}
        
        \PY{n}{NUM\PYZus{}EPOCHS} \PY{o}{=} \PY{l+m+mi}{1000}
        \PY{n}{LEARNING\PYZus{}RATE} \PY{o}{=} \PY{l+m+mf}{1e\PYZhy{}3}
        \PY{n}{CUDA} \PY{o}{=} \PY{k+kc}{False}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{noise\PYZus{}cov} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{p}{)} \PY{o}{*} \PY{n}{noise\PYZus{}ratio}
        \PY{n}{init\PYZus{}v} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{random}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{choice}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{v\PYZus{}norm} \PY{o}{=} \PY{p}{(}\PY{p}{(}\PY{n}{init\PYZus{}v} \PY{o}{*}\PY{o}{*} \PY{l+m+mi}{2} \PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{o}{*}\PY{o}{*} \PY{l+m+mf}{0.5} \PY{c+c1}{\PYZsh{}\PYZsh{} compute norm for each initial velocity}
        \PY{n}{init\PYZus{}v} \PY{o}{=} \PY{n}{init\PYZus{}v} \PY{o}{/} \PY{n}{v\PYZus{}norm} \PY{o}{*} \PY{n}{dt} \PY{c+c1}{\PYZsh{}\PYZsh{} to make the velocity lying on a circle}
        
        \PY{n}{STATE}\PY{p}{,} \PY{n}{Disp}\PY{p}{,} \PY{n}{A\PYZus{}true}\PY{p}{,} \PY{n}{Zs\PYZus{}true} \PY{o}{=} \PY{n}{generate\PYZus{}seq}\PY{p}{(}\PY{n}{T}\PY{p}{,} \PY{n}{dt}\PY{p}{,} \PY{n}{Boundary}\PY{p}{,} \PY{n}{init\PYZus{}v}\PY{p}{,} \PY{n}{noise\PYZus{}cov}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}\PYZsh{} true global variables}
        \PY{n}{cov\PYZus{}true} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{tile}\PY{p}{(}\PY{n}{noise\PYZus{}cov}\PY{p}{,} \PY{p}{(}\PY{n}{K}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
        \PY{n}{dirs} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{p}{)}
        \PY{n}{mu\PYZus{}true} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{tile}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{absolute}\PY{p}{(}\PY{n}{init\PYZus{}v}\PY{p}{)}\PY{p}{,} \PY{p}{(}\PY{n}{K}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)} \PY{o}{*} \PY{n}{dirs}
        \PY{n}{Pi\PYZus{}true} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ones}\PY{p}{(}\PY{n}{K}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{n}{K}\PY{p}{)}
        
        \PY{n}{plot\PYZus{}clusters}\PY{p}{(}\PY{n}{Disp}\PY{p}{,} \PY{n}{mu\PYZus{}true}\PY{p}{,} \PY{n}{cov\PYZus{}true}\PY{p}{,} \PY{n}{K}\PY{p}{)}
        \PY{n}{Zs\PYZus{}true} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{from\PYZus{}numpy}\PY{p}{(}\PY{n}{Zs\PYZus{}true}\PY{p}{)}\PY{o}{.}\PY{n}{float}\PY{p}{(}\PY{p}{)}
        \PY{n}{cov\PYZus{}ks} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{from\PYZus{}numpy}\PY{p}{(}\PY{n}{cov\PYZus{}true}\PY{p}{)}\PY{o}{.}\PY{n}{float}\PY{p}{(}\PY{p}{)}
        \PY{n}{mu\PYZus{}ks} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{from\PYZus{}numpy}\PY{p}{(}\PY{n}{mu\PYZus{}true}\PY{p}{)}\PY{o}{.}\PY{n}{float}\PY{p}{(}\PY{p}{)}
        \PY{n}{Pi} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{from\PYZus{}numpy}\PY{p}{(}\PY{n}{Pi\PYZus{}true}\PY{p}{)}\PY{o}{.}\PY{n}{float}\PY{p}{(}\PY{p}{)}
        \PY{n}{A\PYZus{}init} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{from\PYZus{}numpy}\PY{p}{(}\PY{n}{A\PYZus{}true}\PY{p}{)}\PY{o}{.}\PY{n}{float}\PY{p}{(}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}\PYZsh{} piror of A}
        \PY{n}{alpha\PYZus{}trans\PYZus{}0} \PY{o}{=} \PY{n}{initial\PYZus{}trans\PYZus{}prior}\PY{p}{(}\PY{n}{K}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}\PYZsh{} Y}
        \PY{n}{Y} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{from\PYZus{}numpy}\PY{p}{(}\PY{n}{Disp}\PY{p}{)}\PY{o}{.}\PY{n}{float}\PY{p}{(}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{mu\PYZus{}true}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_2_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
[[ 9.9965561   0.26242358]
 [ 9.9965561  -0.26242358]
 [-9.9965561  -0.26242358]
 [-9.9965561   0.26242358]]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{c+c1}{\PYZsh{} A\PYZus{}samples = A\PYZus{}init}
        \PY{c+c1}{\PYZsh{} Zs, log\PYZus{}weights, log\PYZus{}normalizer = smc\PYZus{}hmm(Pi, A\PYZus{}samples, mu\PYZus{}ks, cov\PYZus{}ks, Y, T, D, K, num\PYZus{}particles\PYZus{}smc)}
        \PY{c+c1}{\PYZsh{} Z\PYZus{}ret = resampling\PYZus{}smc(Zs, log\PYZus{}weights)}
        \PY{c+c1}{\PYZsh{} plot\PYZus{}smc\PYZus{}sample(Zs\PYZus{}true, Z\PYZus{}ret)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{c+c1}{\PYZsh{}\PYZsh{} return samples in order to compute the weights and }
        \PY{k}{class} \PY{n+nc}{Encoder}\PY{p}{(}\PY{n}{nn}\PY{o}{.}\PY{n}{Module}\PY{p}{)}\PY{p}{:}
            \PY{k}{def} \PY{n+nf}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{num\PYZus{}obs}\PY{o}{=}\PY{n}{NUM\PYZus{}OBS}\PY{p}{,}
                               \PY{n}{num\PYZus{}hidden}\PY{o}{=}\PY{n}{NUM\PYZus{}HIDDEN}\PY{p}{,}
                               \PY{n}{num\PYZus{}latents}\PY{o}{=}\PY{n}{NUM\PYZus{}LATENTS}\PY{p}{)}\PY{p}{:}
                \PY{n+nb}{super}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n+nv+vm}{\PYZus{}\PYZus{}class\PYZus{}\PYZus{}}\PY{p}{,} \PY{n+nb+bp}{self}\PY{p}{)}\PY{o}{.}\PY{n+nf+fm}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{enc\PYZus{}hidden} \PY{o}{=} \PY{n}{nn}\PY{o}{.}\PY{n}{Sequential}\PY{p}{(}
                    \PY{n}{nn}\PY{o}{.}\PY{n}{Linear}\PY{p}{(}\PY{n}{num\PYZus{}obs}\PY{p}{,} \PY{n}{num\PYZus{}hidden}\PY{p}{)}\PY{p}{,}
                    \PY{n}{nn}\PY{o}{.}\PY{n}{ReLU}\PY{p}{(}\PY{p}{)}\PY{p}{,}
                    \PY{n}{nn}\PY{o}{.}\PY{n}{Linear}\PY{p}{(}\PY{n}{num\PYZus{}hidden}\PY{p}{,} \PY{n}{num\PYZus{}hidden}\PY{p}{)}\PY{p}{,}
                    \PY{n}{nn}\PY{o}{.}\PY{n}{ReLU}\PY{p}{(}\PY{p}{)}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{latent\PYZus{}dir} \PY{o}{=} \PY{n}{nn}\PY{o}{.}\PY{n}{Sequential}\PY{p}{(}
                    \PY{n}{nn}\PY{o}{.}\PY{n}{Linear}\PY{p}{(}\PY{n}{num\PYZus{}hidden}\PY{p}{,} \PY{n}{num\PYZus{}latents}\PY{p}{)}\PY{p}{)}
                
            \PY{k}{def} \PY{n+nf}{forward}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{obs}\PY{p}{,} \PY{n}{prior\PYZus{}sum}\PY{p}{,} \PY{n}{T}\PY{p}{)}\PY{p}{:}
                \PY{n}{A\PYZus{}samples} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{K}\PY{p}{,} \PY{n}{K}\PY{p}{)}\PY{p}{)}
                \PY{n}{hidden} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{enc\PYZus{}hidden}\PY{p}{(}\PY{n}{obs}\PY{p}{)}
                \PY{n}{latents\PYZus{}dirs} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{latent\PYZus{}dir}\PY{p}{(}\PY{n}{hidden}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{view}\PY{p}{(}\PY{n}{K}\PY{p}{,} \PY{n}{K}\PY{p}{)}
                \PY{n}{latents\PYZus{}dirs\PYZus{}norm} \PY{o}{=} \PY{n}{latents\PYZus{}dirs} \PY{o}{/} \PY{n}{latents\PYZus{}dirs}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{n}{prior\PYZus{}sum} \PY{o}{+} \PY{n}{T}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
                \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{K}\PY{p}{)}\PY{p}{:}
                    \PY{n}{A\PYZus{}samples}\PY{p}{[}\PY{n}{k}\PY{p}{]} \PY{o}{=} \PY{n}{Dirichlet}\PY{p}{(}\PY{n}{latents\PYZus{}dirs}\PY{p}{[}\PY{n}{k}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{p}{)}
                \PY{k}{return} \PY{n}{latents\PYZus{}dirs}\PY{p}{,} \PY{n}{A\PYZus{}samples}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{k}{def} \PY{n+nf}{initialize}\PY{p}{(}\PY{p}{)}\PY{p}{:}
            \PY{n}{enc} \PY{o}{=} \PY{n}{Encoder}\PY{p}{(}\PY{p}{)}
            \PY{k}{if} \PY{n}{CUDA}\PY{p}{:}
                \PY{n}{enc}\PY{o}{.}\PY{n}{cuda}\PY{p}{(}\PY{p}{)}
            \PY{n}{optimizer} \PY{o}{=}  \PY{n}{torch}\PY{o}{.}\PY{n}{optim}\PY{o}{.}\PY{n}{Adam}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n}{enc}\PY{o}{.}\PY{n}{parameters}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{lr}\PY{o}{=}\PY{n}{LEARNING\PYZus{}RATE}\PY{p}{)}    
            \PY{k}{return} \PY{n}{enc}\PY{p}{,} \PY{n}{optimizer}
        \PY{n}{enc}\PY{p}{,} \PY{n}{optimizer} \PY{o}{=} \PY{n}{initialize}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{KLs} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        \PY{n}{EUBOs} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        \PY{n}{log\PYZus{}p\PYZus{}conds} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        \PY{n}{log\PYZus{}qs} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        \PY{n}{ESSs} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        
        \PY{k}{for} \PY{n}{epoch} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{NUM\PYZus{}EPOCHS}\PY{p}{)}\PY{p}{:}
            \PY{n}{time\PYZus{}start} \PY{o}{=} \PY{n}{time}\PY{o}{.}\PY{n}{time}\PY{p}{(}\PY{p}{)}
            \PY{n}{optimizer}\PY{o}{.}\PY{n}{zero\PYZus{}grad}\PY{p}{(}\PY{p}{)}
            \PY{n}{init\PYZus{}v} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{random}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{choice}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
            \PY{n}{v\PYZus{}norm} \PY{o}{=} \PY{p}{(}\PY{p}{(}\PY{n}{init\PYZus{}v} \PY{o}{*}\PY{o}{*} \PY{l+m+mi}{2} \PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{o}{*}\PY{o}{*} \PY{l+m+mf}{0.5} \PY{c+c1}{\PYZsh{}\PYZsh{} compute norm for each initial velocity}
            \PY{n}{init\PYZus{}v} \PY{o}{=} \PY{n}{init\PYZus{}v} \PY{o}{/} \PY{n}{v\PYZus{}norm} \PY{o}{*} \PY{n}{dt} \PY{c+c1}{\PYZsh{}\PYZsh{} to make the velocity lying on a circle}
            \PY{n}{T} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{l+m+mi}{30}\PY{p}{,} \PY{l+m+mi}{50}\PY{p}{)}
            \PY{n}{STATE}\PY{p}{,} \PY{n}{Disp}\PY{p}{,} \PY{n}{A\PYZus{}true}\PY{p}{,} \PY{n}{Zs\PYZus{}true} \PY{o}{=} \PY{n}{generate\PYZus{}seq}\PY{p}{(}\PY{n}{T}\PY{p}{,} \PY{n}{dt}\PY{p}{,} \PY{n}{Boundary}\PY{p}{,} \PY{n}{init\PYZus{}v}\PY{p}{,} \PY{n}{noise\PYZus{}cov}\PY{p}{)}
            \PY{c+c1}{\PYZsh{}\PYZsh{} true global variables}
            \PY{n}{cov\PYZus{}true} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{tile}\PY{p}{(}\PY{n}{noise\PYZus{}cov}\PY{p}{,} \PY{p}{(}\PY{n}{K}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
            \PY{n}{dirs} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{p}{)}
            \PY{n}{mu\PYZus{}true} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{tile}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{absolute}\PY{p}{(}\PY{n}{init\PYZus{}v}\PY{p}{)}\PY{p}{,} \PY{p}{(}\PY{n}{K}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)} \PY{o}{*} \PY{n}{dirs}
            \PY{n}{Pi\PYZus{}true} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ones}\PY{p}{(}\PY{n}{K}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{n}{K}\PY{p}{)}
            \PY{n}{cov\PYZus{}ks} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{from\PYZus{}numpy}\PY{p}{(}\PY{n}{cov\PYZus{}true}\PY{p}{)}\PY{o}{.}\PY{n}{float}\PY{p}{(}\PY{p}{)}
            \PY{n}{mu\PYZus{}ks} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{from\PYZus{}numpy}\PY{p}{(}\PY{n}{mu\PYZus{}true}\PY{p}{)}\PY{o}{.}\PY{n}{float}\PY{p}{(}\PY{p}{)}
            \PY{n}{Pi} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{from\PYZus{}numpy}\PY{p}{(}\PY{n}{Pi\PYZus{}true}\PY{p}{)}\PY{o}{.}\PY{n}{float}\PY{p}{(}\PY{p}{)}
            \PY{n}{A\PYZus{}init} \PY{o}{=} \PY{n}{initial\PYZus{}trans}\PY{p}{(}\PY{n}{alpha\PYZus{}trans\PYZus{}0}\PY{p}{,} \PY{n}{K}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}     A\PYZus{}init = torch.from\PYZus{}numpy(A\PYZus{}true).float()}
            \PY{n}{alpha\PYZus{}trans\PYZus{}0} \PY{o}{=} \PY{n}{initial\PYZus{}trans\PYZus{}prior}\PY{p}{(}\PY{n}{K}\PY{p}{)}
            \PY{n}{Y} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{from\PYZus{}numpy}\PY{p}{(}\PY{n}{Disp}\PY{p}{)}\PY{o}{.}\PY{n}{float}\PY{p}{(}\PY{p}{)}
            
        
            \PY{n}{enc}\PY{p}{,} \PY{n}{loss\PYZus{}infer}\PY{p}{,} \PY{n}{eubo}\PY{p}{,} \PY{n}{kl}\PY{p}{,} \PY{n}{ess}\PY{p}{,} \PY{n}{latents\PYZus{}dirs}\PY{p}{,} \PY{n}{Z\PYZus{}ret} \PY{o}{=} \PY{n}{rws}\PY{p}{(}\PY{n}{enc}\PY{p}{,} \PY{n}{A\PYZus{}init}\PY{p}{,} \PY{n}{alpha\PYZus{}trans\PYZus{}0}\PY{p}{,} \PY{n}{Pi}\PY{p}{,} \PY{n}{mu\PYZus{}ks}\PY{p}{,} \PY{n}{cov\PYZus{}ks}\PY{p}{,} \PY{n}{Y}\PY{p}{,} \PY{n}{T}\PY{p}{,} \PY{n}{D}\PY{p}{,} \PY{n}{K}\PY{p}{,} \PY{n}{num\PYZus{}particles\PYZus{}rws}\PY{p}{,} \PY{n}{num\PYZus{}particles\PYZus{}smc}\PY{p}{,} \PY{n}{mcmc\PYZus{}steps}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}     kl\PYZus{}est = torch.mul(weights\PYZus{}rws, log\PYZus{}p\PYZus{}conds \PYZhy{} log\PYZus{}qs).sum().detach().item()}
            \PY{n}{log\PYZus{}q} \PY{o}{=} \PY{o}{\PYZhy{}} \PY{n}{loss\PYZus{}infer}
            \PY{n}{eubo}\PY{o}{.}\PY{n}{backward}\PY{p}{(}\PY{p}{)}
            \PY{n}{KLs}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{kl}\PY{o}{.}\PY{n}{item}\PY{p}{(}\PY{p}{)}\PY{p}{)}
            \PY{n}{EUBOs}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{eubo}\PY{p}{)}
            \PY{n}{ESSs}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{ess}\PY{p}{)}
            \PY{n}{log\PYZus{}qs}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{log\PYZus{}q}\PY{p}{)}
            \PY{n}{optimizer}\PY{o}{.}\PY{n}{step}\PY{p}{(}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}     A\PYZus{}samples = A\PYZus{}samples.detach()}
            \PY{n}{time\PYZus{}end} \PY{o}{=} \PY{n}{time}\PY{o}{.}\PY{n}{time}\PY{p}{(}\PY{p}{)}
            \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{epoch : }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{, eubo : }\PY{l+s+si}{\PYZpc{}f}\PY{l+s+s1}{, log\PYZus{}q : }\PY{l+s+si}{\PYZpc{}f}\PY{l+s+s1}{, KL : }\PY{l+s+si}{\PYZpc{}f}\PY{l+s+s1}{ (}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{s)}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{epoch}\PY{p}{,} \PY{n}{eubo}\PY{p}{,} \PY{n}{log\PYZus{}q}\PY{p}{,} \PY{n}{kl}\PY{p}{,} \PY{n}{time\PYZus{}end} \PY{o}{\PYZhy{}} \PY{n}{time\PYZus{}start}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
epoch : 0, eubo : -495.227509, log\_q : 21.483521, KL : 515.740906 (28s)
epoch : 1, eubo : -470.983765, log\_q : 19.857452, KL : 509.728821 (37s)
epoch : 2, eubo : -344.685669, log\_q : 19.830418, KL : 341.566772 (26s)
epoch : 3, eubo : -543.566772, log\_q : 23.902023, KL : 303.597443 (36s)
epoch : 4, eubo : -357.554626, log\_q : 19.213902, KL : 329.702057 (29s)
epoch : 5, eubo : -375.337982, log\_q : 20.276146, KL : 299.369354 (23s)
epoch : 6, eubo : -291.386047, log\_q : 20.360628, KL : 291.341797 (24s)
epoch : 7, eubo : -367.602020, log\_q : 22.714094, KL : 301.118164 (28s)
epoch : 8, eubo : -342.809540, log\_q : 19.574106, KL : 319.371185 (27s)
epoch : 9, eubo : -408.474152, log\_q : 22.403126, KL : 461.423187 (34s)
epoch : 10, eubo : -420.152191, log\_q : 21.556782, KL : 315.793488 (28s)
epoch : 11, eubo : -287.371216, log\_q : 22.678141, KL : 277.643799 (24s)
epoch : 12, eubo : -497.803314, log\_q : 20.630043, KL : 320.589386 (30s)
epoch : 13, eubo : -360.915283, log\_q : 21.403126, KL : 313.471008 (28s)
epoch : 14, eubo : -574.217224, log\_q : 18.637955, KL : 281.960815 (27s)
epoch : 15, eubo : -375.696594, log\_q : 19.787548, KL : 334.765564 (33s)
epoch : 16, eubo : -475.627777, log\_q : 23.455660, KL : 251.312927 (26s)
epoch : 17, eubo : -451.029388, log\_q : 23.178745, KL : 358.070404 (38s)
epoch : 18, eubo : -373.584381, log\_q : 21.365303, KL : 248.940247 (31s)
epoch : 19, eubo : -297.499359, log\_q : 21.539351, KL : 300.437164 (30s)
epoch : 20, eubo : -268.445312, log\_q : 17.967541, KL : 212.291122 (26s)
epoch : 21, eubo : -358.456299, log\_q : 21.168251, KL : 275.257416 (29s)
epoch : 22, eubo : -394.810760, log\_q : 23.801128, KL : 190.890961 (26s)
epoch : 23, eubo : -518.101990, log\_q : 21.240547, KL : 241.946671 (35s)
epoch : 24, eubo : -355.210541, log\_q : 22.289417, KL : 219.840195 (29s)
epoch : 25, eubo : -396.733154, log\_q : 25.115332, KL : 274.408508 (34s)
epoch : 26, eubo : -322.346069, log\_q : 23.702486, KL : 138.157120 (25s)
epoch : 27, eubo : -358.746826, log\_q : 22.550797, KL : 203.140717 (33s)
epoch : 28, eubo : -350.870026, log\_q : 21.662237, KL : 197.565277 (35s)
epoch : 29, eubo : -282.395325, log\_q : 18.329666, KL : 142.628708 (23s)
epoch : 30, eubo : -369.870209, log\_q : 20.711798, KL : 212.897247 (37s)
epoch : 31, eubo : -269.279510, log\_q : 24.203289, KL : 111.405304 (23s)
epoch : 32, eubo : -399.625854, log\_q : 23.741253, KL : 144.038208 (31s)
epoch : 33, eubo : -356.270203, log\_q : 22.311678, KL : 113.728668 (23s)
epoch : 34, eubo : -510.304047, log\_q : 30.093248, KL : 273.521973 (37s)
epoch : 35, eubo : -418.039398, log\_q : 22.373684, KL : 115.025337 (23s)
epoch : 36, eubo : -385.297424, log\_q : 25.446188, KL : 174.453156 (30s)
epoch : 37, eubo : -389.878052, log\_q : 27.369350, KL : 102.466507 (23s)
epoch : 38, eubo : -337.877380, log\_q : 26.805084, KL : 180.223953 (30s)
epoch : 39, eubo : -424.892365, log\_q : 29.276321, KL : 203.509521 (31s)
epoch : 40, eubo : -446.061584, log\_q : 31.506594, KL : 167.108810 (37s)
epoch : 41, eubo : -323.196136, log\_q : 27.323389, KL : 159.983719 (29s)
epoch : 42, eubo : -382.230377, log\_q : 22.671591, KL : 208.108444 (29s)
epoch : 43, eubo : -384.441742, log\_q : 27.546558, KL : 207.637375 (32s)
epoch : 44, eubo : -309.648468, log\_q : 25.965031, KL : 168.479233 (26s)
epoch : 45, eubo : -436.697113, log\_q : 32.835384, KL : 174.675156 (29s)
epoch : 46, eubo : -440.633514, log\_q : 28.665592, KL : 211.706070 (35s)
epoch : 47, eubo : -376.013763, log\_q : 26.827961, KL : 171.767334 (37s)
epoch : 48, eubo : -474.477997, log\_q : 30.899345, KL : 175.111435 (35s)
epoch : 49, eubo : -359.565826, log\_q : 26.163244, KL : 131.550766 (27s)
epoch : 50, eubo : -384.630127, log\_q : 27.558058, KL : 146.007919 (29s)
epoch : 51, eubo : -416.632965, log\_q : 28.179390, KL : 152.611221 (37s)
epoch : 52, eubo : -392.974426, log\_q : 25.621845, KL : 83.282928 (23s)
epoch : 53, eubo : -308.855225, log\_q : 28.639208, KL : 112.516907 (28s)
epoch : 54, eubo : -304.764801, log\_q : 26.198561, KL : 112.204544 (23s)
epoch : 55, eubo : -541.585327, log\_q : 35.782764, KL : 125.656181 (38s)
epoch : 56, eubo : -472.127869, log\_q : 27.345787, KL : 156.683914 (34s)
epoch : 57, eubo : -363.550873, log\_q : 26.807465, KL : 153.267593 (34s)
epoch : 58, eubo : -248.799042, log\_q : 21.413183, KL : 130.223785 (27s)
epoch : 59, eubo : -292.564636, log\_q : 32.619690, KL : 178.072281 (30s)
epoch : 60, eubo : -314.762665, log\_q : 21.203093, KL : 127.796501 (28s)
epoch : 61, eubo : -336.410126, log\_q : 25.953400, KL : 97.282494 (25s)
epoch : 62, eubo : -379.328552, log\_q : 28.868568, KL : 135.629272 (32s)
epoch : 63, eubo : -409.345184, log\_q : 29.500473, KL : 165.971893 (32s)
epoch : 64, eubo : -465.479736, log\_q : 25.972460, KL : 158.996826 (37s)
epoch : 65, eubo : -246.985138, log\_q : 26.336189, KL : 116.706329 (23s)
epoch : 66, eubo : -463.115570, log\_q : 26.515802, KL : 194.533981 (35s)
epoch : 67, eubo : -298.304626, log\_q : 26.152391, KL : 126.852570 (27s)
epoch : 68, eubo : -458.368286, log\_q : 28.470261, KL : 136.580643 (33s)
epoch : 69, eubo : -272.482056, log\_q : 24.852262, KL : 153.051315 (23s)
epoch : 70, eubo : -550.104858, log\_q : 29.877741, KL : 134.999786 (32s)
epoch : 71, eubo : -408.151978, log\_q : 29.678522, KL : 210.017044 (33s)
epoch : 72, eubo : -489.123840, log\_q : 29.324013, KL : 207.470016 (38s)
epoch : 73, eubo : -358.657623, log\_q : 29.606466, KL : 112.294937 (26s)
epoch : 74, eubo : -461.712189, log\_q : 26.766155, KL : 127.063789 (28s)
epoch : 75, eubo : -378.215363, log\_q : 24.495911, KL : 201.405899 (29s)
epoch : 76, eubo : -353.701111, log\_q : 28.288082, KL : 113.754387 (29s)
epoch : 77, eubo : -384.791534, log\_q : 29.536484, KL : 112.053024 (29s)
epoch : 78, eubo : -457.542297, log\_q : 27.007128, KL : 185.359192 (28s)
epoch : 79, eubo : -297.154938, log\_q : 25.472631, KL : 133.097198 (24s)
epoch : 80, eubo : -435.158752, log\_q : 30.866333, KL : 191.511719 (27s)
epoch : 81, eubo : -365.771423, log\_q : 26.178343, KL : 138.926926 (36s)
epoch : 82, eubo : -414.830963, log\_q : 30.490639, KL : 109.279137 (28s)
epoch : 83, eubo : -357.023041, log\_q : 28.145073, KL : 114.442177 (30s)
epoch : 84, eubo : -454.077515, log\_q : 26.792568, KL : 125.392410 (34s)
epoch : 85, eubo : -309.490051, log\_q : 23.027338, KL : 109.127472 (25s)
epoch : 86, eubo : -433.524048, log\_q : 31.093834, KL : 156.367722 (36s)
epoch : 87, eubo : -626.531494, log\_q : 30.156923, KL : 101.058678 (29s)
epoch : 88, eubo : -290.647614, log\_q : 29.286518, KL : 121.505615 (25s)
epoch : 89, eubo : -351.436340, log\_q : 24.772659, KL : 90.994553 (25s)
epoch : 90, eubo : -205.561646, log\_q : 26.649586, KL : 120.863464 (23s)
epoch : 91, eubo : -452.674347, log\_q : 26.631618, KL : 128.924973 (28s)
epoch : 92, eubo : -359.204987, log\_q : 26.760790, KL : 137.245270 (30s)
epoch : 93, eubo : -498.797821, log\_q : 24.407656, KL : 136.157104 (30s)
epoch : 94, eubo : -312.603424, log\_q : 24.759417, KL : 78.309235 (23s)
epoch : 95, eubo : -390.192169, log\_q : 29.041939, KL : 130.134827 (35s)
epoch : 96, eubo : -316.174469, log\_q : 26.871447, KL : 134.480118 (31s)
epoch : 97, eubo : -399.022766, log\_q : 25.665075, KL : 92.871109 (30s)
epoch : 98, eubo : -323.610291, log\_q : 26.411108, KL : 99.936790 (28s)
epoch : 99, eubo : -300.821808, log\_q : 23.226023, KL : 71.976250 (23s)
epoch : 100, eubo : -434.521820, log\_q : 25.796034, KL : 140.950226 (35s)
epoch : 101, eubo : -482.575500, log\_q : 27.394156, KL : 109.153839 (24s)
epoch : 102, eubo : -352.127747, log\_q : 25.172123, KL : 64.825027 (28s)
epoch : 103, eubo : -378.264465, log\_q : 28.964981, KL : 109.820770 (34s)
epoch : 104, eubo : -327.308716, log\_q : 26.505693, KL : 109.300766 (25s)
epoch : 105, eubo : -278.566101, log\_q : 23.759314, KL : 73.349937 (24s)
epoch : 106, eubo : -359.028442, log\_q : 25.396389, KL : 123.515526 (32s)
epoch : 107, eubo : -454.646210, log\_q : 24.050526, KL : 143.962097 (35s)
epoch : 108, eubo : -387.929871, log\_q : 25.147301, KL : 74.071541 (27s)
epoch : 109, eubo : -484.515106, log\_q : 27.466280, KL : 124.840027 (36s)
epoch : 110, eubo : -387.108398, log\_q : 24.886488, KL : 85.825455 (27s)
epoch : 111, eubo : -372.006744, log\_q : 23.225208, KL : 110.736877 (31s)
epoch : 112, eubo : -385.270081, log\_q : 24.318033, KL : 102.402245 (32s)
epoch : 113, eubo : -312.643677, log\_q : 27.301985, KL : 112.678787 (33s)
epoch : 114, eubo : -399.885498, log\_q : 25.968124, KL : 84.375168 (25s)
epoch : 115, eubo : -326.724976, log\_q : 24.460434, KL : 92.327965 (24s)
epoch : 116, eubo : -397.940277, log\_q : 24.996391, KL : 117.116432 (35s)
epoch : 117, eubo : -322.935699, log\_q : 24.035435, KL : 118.512489 (24s)
epoch : 118, eubo : -491.459717, log\_q : 18.304790, KL : 115.527412 (34s)
epoch : 119, eubo : -345.684906, log\_q : 24.825985, KL : 98.804787 (29s)
epoch : 120, eubo : -507.783691, log\_q : 23.492575, KL : 102.233887 (37s)
epoch : 121, eubo : -424.294769, log\_q : 21.619429, KL : 75.539047 (30s)
epoch : 122, eubo : -432.911743, log\_q : 23.875549, KL : 99.599503 (30s)
epoch : 123, eubo : -425.416382, log\_q : 26.968872, KL : 107.123985 (37s)
epoch : 124, eubo : -380.220184, log\_q : 24.575069, KL : 76.468430 (30s)
epoch : 125, eubo : -300.062500, log\_q : 25.016777, KL : 59.384121 (24s)
epoch : 126, eubo : -547.382812, log\_q : 25.515032, KL : 137.113312 (31s)
epoch : 127, eubo : -432.135284, log\_q : 22.691023, KL : 105.015625 (27s)
epoch : 128, eubo : -482.543762, log\_q : 26.041918, KL : 117.049538 (35s)
epoch : 129, eubo : -322.853821, log\_q : 26.597771, KL : 101.980957 (27s)
epoch : 130, eubo : -387.286926, log\_q : 23.553394, KL : 89.745010 (34s)
epoch : 131, eubo : -417.711975, log\_q : 25.531864, KL : 155.735321 (37s)
epoch : 132, eubo : -352.506104, log\_q : 26.261940, KL : 82.412743 (32s)
epoch : 133, eubo : -371.943024, log\_q : 24.340200, KL : 97.849396 (33s)
epoch : 134, eubo : -395.388031, log\_q : 25.420704, KL : 76.959091 (35s)
epoch : 135, eubo : -440.485718, log\_q : 26.444107, KL : 82.770737 (29s)
epoch : 136, eubo : -507.134125, log\_q : 25.554482, KL : 105.862740 (36s)
epoch : 137, eubo : -407.096680, log\_q : 17.733355, KL : 93.172935 (36s)
epoch : 138, eubo : -285.356140, log\_q : 24.940870, KL : 60.290504 (24s)
epoch : 139, eubo : -341.912903, log\_q : 23.286276, KL : 93.088028 (30s)
epoch : 140, eubo : -321.520020, log\_q : 21.271090, KL : 66.539948 (28s)
epoch : 141, eubo : -373.901917, log\_q : 23.933895, KL : 121.272026 (37s)
epoch : 142, eubo : -398.862274, log\_q : 22.968637, KL : 86.398827 (35s)
epoch : 143, eubo : -387.817047, log\_q : 23.364361, KL : 85.471001 (34s)
epoch : 144, eubo : -475.860107, log\_q : 24.521425, KL : 86.587975 (37s)
epoch : 145, eubo : -340.731140, log\_q : 26.481394, KL : 126.545135 (32s)
epoch : 146, eubo : -360.847260, log\_q : 20.585377, KL : 70.613747 (26s)
epoch : 147, eubo : -439.013367, log\_q : 24.835392, KL : 107.346603 (34s)
epoch : 148, eubo : -291.000214, log\_q : 24.445997, KL : 121.322990 (36s)
epoch : 149, eubo : -336.347260, log\_q : 21.200994, KL : 57.592407 (26s)
epoch : 150, eubo : -362.122162, log\_q : 18.820484, KL : 67.016586 (30s)
epoch : 151, eubo : -603.856201, log\_q : 21.294504, KL : 107.742439 (30s)
epoch : 152, eubo : -334.502167, log\_q : 20.871445, KL : 70.282883 (27s)
epoch : 153, eubo : -478.098694, log\_q : 20.580706, KL : 89.959282 (30s)
epoch : 154, eubo : -572.426086, log\_q : 20.622139, KL : 118.360672 (37s)
epoch : 155, eubo : -231.598343, log\_q : 26.882610, KL : 78.652214 (26s)
epoch : 156, eubo : -276.080688, log\_q : 24.168694, KL : 65.063393 (29s)
epoch : 157, eubo : -319.277924, log\_q : 18.218119, KL : 67.852524 (23s)
epoch : 158, eubo : -405.267212, log\_q : 22.475391, KL : 69.995384 (33s)
epoch : 159, eubo : -283.236542, log\_q : 22.873056, KL : 101.609688 (32s)
epoch : 160, eubo : -397.494965, log\_q : 24.356470, KL : 182.167328 (31s)
epoch : 161, eubo : -436.899048, log\_q : 25.427990, KL : 96.973160 (34s)
epoch : 162, eubo : -376.052216, log\_q : 25.617418, KL : 67.184258 (29s)
epoch : 163, eubo : -263.471863, log\_q : 18.562765, KL : 45.439163 (23s)
epoch : 164, eubo : -350.042084, log\_q : 24.724485, KL : 59.648304 (29s)
epoch : 165, eubo : -451.243408, log\_q : 25.708952, KL : 78.624084 (33s)
epoch : 166, eubo : -333.370483, log\_q : 21.812572, KL : 66.412560 (27s)
epoch : 167, eubo : -517.246704, log\_q : 25.754667, KL : 61.800007 (34s)
epoch : 168, eubo : -542.917236, log\_q : 26.217978, KL : 85.230537 (24s)
epoch : 169, eubo : -526.338196, log\_q : 23.685223, KL : 59.223915 (30s)
epoch : 170, eubo : -299.360138, log\_q : 25.511976, KL : 95.187965 (27s)
epoch : 171, eubo : -374.680511, log\_q : 22.109056, KL : 87.939949 (31s)
epoch : 172, eubo : -411.717133, log\_q : 23.271311, KL : 78.111992 (27s)
epoch : 173, eubo : -348.978912, log\_q : 25.717945, KL : 74.379013 (32s)
epoch : 174, eubo : -404.422913, log\_q : 24.147532, KL : 68.486435 (34s)
epoch : 175, eubo : -261.612335, log\_q : 23.757956, KL : 57.613991 (27s)
epoch : 176, eubo : -364.500641, log\_q : 25.456135, KL : 106.139313 (34s)
epoch : 177, eubo : -513.034241, log\_q : 25.451872, KL : 56.782108 (24s)
epoch : 178, eubo : -265.567993, log\_q : 14.974724, KL : 56.672279 (27s)
epoch : 179, eubo : -313.687408, log\_q : 24.427532, KL : 145.487595 (32s)
epoch : 180, eubo : -433.395935, log\_q : 26.661072, KL : 87.200119 (36s)
epoch : 181, eubo : -379.435791, log\_q : 25.219370, KL : 149.437683 (35s)
epoch : 182, eubo : -486.916870, log\_q : 24.714952, KL : 123.604752 (34s)
epoch : 183, eubo : -499.547546, log\_q : 28.646994, KL : 67.595306 (29s)
epoch : 184, eubo : -440.709167, log\_q : 30.065546, KL : 73.443901 (36s)
epoch : 185, eubo : -251.325912, log\_q : 23.576500, KL : 54.033489 (25s)
epoch : 186, eubo : -383.564056, log\_q : 22.230167, KL : 59.325111 (27s)
epoch : 187, eubo : -258.985657, log\_q : 21.586929, KL : 54.704933 (24s)
epoch : 188, eubo : -318.728973, log\_q : 22.661633, KL : 73.578148 (24s)
epoch : 189, eubo : -359.905579, log\_q : 20.190601, KL : 42.418289 (24s)
epoch : 190, eubo : -559.913269, log\_q : 22.267502, KL : 65.982300 (26s)
epoch : 191, eubo : -333.024689, log\_q : 20.974777, KL : 109.266220 (34s)
epoch : 192, eubo : -378.939545, log\_q : 24.489111, KL : 80.224197 (33s)
epoch : 193, eubo : -425.517365, log\_q : 22.450027, KL : 51.304836 (32s)
epoch : 194, eubo : -310.759796, log\_q : 19.587902, KL : 72.450363 (27s)
epoch : 195, eubo : -517.816101, log\_q : 18.234913, KL : 58.265709 (29s)
epoch : 196, eubo : -406.752838, log\_q : 21.680431, KL : 76.810143 (28s)
epoch : 197, eubo : -424.598022, log\_q : 23.740843, KL : 73.215088 (32s)
epoch : 198, eubo : -400.836609, log\_q : 18.601669, KL : 64.295906 (23s)
epoch : 199, eubo : -377.210510, log\_q : 23.186638, KL : 60.176411 (25s)
epoch : 200, eubo : -337.909912, log\_q : 27.975462, KL : 111.531662 (27s)
epoch : 201, eubo : -265.546295, log\_q : 22.012491, KL : 69.850723 (34s)
epoch : 202, eubo : -502.560333, log\_q : 23.452009, KL : 74.068214 (37s)
epoch : 203, eubo : -294.982849, log\_q : 20.337307, KL : 66.824707 (34s)
epoch : 204, eubo : -382.594910, log\_q : 16.083307, KL : 38.804729 (24s)
epoch : 205, eubo : -424.581085, log\_q : 25.614660, KL : 105.448143 (36s)
epoch : 206, eubo : -298.493134, log\_q : 22.352505, KL : 91.158546 (28s)
epoch : 207, eubo : -371.755157, log\_q : 21.387451, KL : 62.356564 (30s)
epoch : 208, eubo : -342.147491, log\_q : 23.997469, KL : 60.912491 (33s)
epoch : 209, eubo : -391.799744, log\_q : 24.090170, KL : 67.192291 (32s)
epoch : 210, eubo : -327.864777, log\_q : 22.171064, KL : 76.689812 (29s)
epoch : 211, eubo : -400.201660, log\_q : 23.696169, KL : 64.979301 (27s)
epoch : 212, eubo : -353.543549, log\_q : 19.557573, KL : 85.120308 (30s)
epoch : 213, eubo : -351.238373, log\_q : 21.876110, KL : 49.347115 (28s)
epoch : 214, eubo : -360.101044, log\_q : 21.213257, KL : 46.001286 (29s)
epoch : 215, eubo : -337.803528, log\_q : 18.798948, KL : 49.709660 (26s)
epoch : 216, eubo : -331.270264, log\_q : 20.267645, KL : 54.983452 (28s)
epoch : 217, eubo : -505.246796, log\_q : 20.955210, KL : 74.048813 (28s)
epoch : 218, eubo : -409.952209, log\_q : 22.521965, KL : 82.083359 (33s)
epoch : 219, eubo : -382.110962, log\_q : 26.423365, KL : 61.861996 (35s)
epoch : 220, eubo : -357.575195, log\_q : 21.590637, KL : 42.525665 (29s)
epoch : 221, eubo : -308.358185, log\_q : 20.098654, KL : 60.347034 (26s)
epoch : 222, eubo : -440.762329, log\_q : 14.692634, KL : 54.709648 (26s)
epoch : 223, eubo : -308.736359, log\_q : 20.550575, KL : 62.168182 (28s)
epoch : 224, eubo : -430.405701, log\_q : 20.897413, KL : 91.736107 (36s)
epoch : 225, eubo : -405.768219, log\_q : 22.750690, KL : 52.896370 (33s)
epoch : 226, eubo : -449.318787, log\_q : 23.912281, KL : 70.471062 (36s)
epoch : 227, eubo : -550.021729, log\_q : 22.979841, KL : 62.923996 (36s)
epoch : 228, eubo : -329.558350, log\_q : 20.222576, KL : 54.480083 (26s)
epoch : 229, eubo : -346.335632, log\_q : 19.072102, KL : 46.724236 (23s)
epoch : 230, eubo : -231.467667, log\_q : 21.045124, KL : 49.704170 (24s)
epoch : 231, eubo : -508.513763, log\_q : 20.504969, KL : 56.337765 (36s)
epoch : 232, eubo : -434.247467, log\_q : 22.510668, KL : 59.159210 (33s)
epoch : 233, eubo : -335.191681, log\_q : 20.292551, KL : 55.725914 (24s)
epoch : 234, eubo : -350.765625, log\_q : 20.237480, KL : 58.670544 (33s)
epoch : 235, eubo : -459.180481, log\_q : 21.544268, KL : 72.036201 (28s)
epoch : 236, eubo : -372.720184, log\_q : 19.966375, KL : 51.010620 (28s)
epoch : 237, eubo : -279.356689, log\_q : 17.989605, KL : 47.582161 (23s)
epoch : 238, eubo : -420.249329, log\_q : 19.390928, KL : 33.366371 (27s)
epoch : 239, eubo : -440.208130, log\_q : 25.620022, KL : 77.756653 (31s)
epoch : 240, eubo : -428.235168, log\_q : 21.708294, KL : 36.084793 (25s)
epoch : 241, eubo : -544.294495, log\_q : 21.947519, KL : 47.883450 (36s)
epoch : 242, eubo : -411.105347, log\_q : 22.118755, KL : 52.456863 (30s)
epoch : 243, eubo : -409.512848, log\_q : 22.494019, KL : 29.276861 (31s)
epoch : 244, eubo : -372.271790, log\_q : 21.904276, KL : 53.679363 (24s)
epoch : 245, eubo : -344.241913, log\_q : 20.586205, KL : 29.877018 (23s)
epoch : 246, eubo : -561.270203, log\_q : 27.117559, KL : 72.271606 (35s)
epoch : 247, eubo : -269.920227, log\_q : 14.444921, KL : 35.985279 (23s)
epoch : 248, eubo : -363.018433, log\_q : 23.398638, KL : 33.329708 (28s)
epoch : 249, eubo : -378.758423, log\_q : 21.426352, KL : 37.714794 (23s)
epoch : 250, eubo : -375.676117, log\_q : 24.276531, KL : 51.663059 (34s)
epoch : 251, eubo : -337.169495, log\_q : 22.696136, KL : 36.423634 (24s)
epoch : 252, eubo : -439.331543, log\_q : 25.367321, KL : 43.291721 (34s)
epoch : 253, eubo : -372.182068, log\_q : 24.490850, KL : 52.467709 (27s)
epoch : 254, eubo : -282.187805, log\_q : 16.678667, KL : 28.674490 (26s)
epoch : 255, eubo : -234.390411, log\_q : 22.631891, KL : 37.762600 (23s)
epoch : 256, eubo : -288.096771, log\_q : 21.972073, KL : 32.608368 (31s)
epoch : 257, eubo : -308.936157, log\_q : 22.295958, KL : 79.874916 (30s)
epoch : 258, eubo : -424.369385, log\_q : 20.218092, KL : 30.109865 (32s)
epoch : 259, eubo : -463.029175, log\_q : 21.706343, KL : 42.550526 (34s)
epoch : 260, eubo : -320.121002, log\_q : 18.978067, KL : 29.897429 (24s)
epoch : 261, eubo : -446.885925, log\_q : 23.952604, KL : 41.896500 (33s)
epoch : 262, eubo : -399.159058, log\_q : 15.501793, KL : 29.044006 (24s)
epoch : 263, eubo : -328.798737, log\_q : 22.949684, KL : 48.439999 (31s)
epoch : 264, eubo : -371.780121, log\_q : 24.024115, KL : 38.985546 (36s)
epoch : 265, eubo : -446.603943, log\_q : 24.933716, KL : 55.899990 (37s)
epoch : 266, eubo : -414.372437, log\_q : 20.872337, KL : 35.538437 (27s)
epoch : 267, eubo : -469.911163, log\_q : 20.246374, KL : 25.693527 (35s)
epoch : 268, eubo : -371.194031, log\_q : 19.185837, KL : 44.140358 (25s)
epoch : 269, eubo : -281.601257, log\_q : 19.874552, KL : 34.927937 (29s)
epoch : 270, eubo : -303.865356, log\_q : 18.392250, KL : 30.152704 (26s)
epoch : 271, eubo : -473.240112, log\_q : 24.299509, KL : 32.907936 (32s)
epoch : 272, eubo : -239.721115, log\_q : 23.868439, KL : 46.084454 (25s)
epoch : 273, eubo : -481.293549, log\_q : 24.313221, KL : 22.572006 (37s)
epoch : 274, eubo : -409.640503, log\_q : 24.322832, KL : 37.735817 (34s)
epoch : 275, eubo : -376.557648, log\_q : 21.933281, KL : 44.842529 (29s)
epoch : 276, eubo : -352.569000, log\_q : 14.165025, KL : 42.684029 (36s)
epoch : 277, eubo : -437.267578, log\_q : 16.779123, KL : 46.042976 (28s)
epoch : 278, eubo : -326.886749, log\_q : 18.179771, KL : 19.570351 (26s)
epoch : 279, eubo : -380.216888, log\_q : 16.722275, KL : 29.345404 (30s)
epoch : 280, eubo : -345.317841, log\_q : 12.086795, KL : 34.470699 (33s)
epoch : 281, eubo : -325.420624, log\_q : 20.721289, KL : 30.552723 (26s)
epoch : 282, eubo : -363.185303, log\_q : 25.309717, KL : 102.888779 (37s)
epoch : 283, eubo : -336.200958, log\_q : 21.823290, KL : 34.165173 (26s)
epoch : 284, eubo : -368.394043, log\_q : 16.506678, KL : 20.711191 (24s)
epoch : 285, eubo : -450.009247, log\_q : 21.207657, KL : 21.938908 (36s)
epoch : 286, eubo : -415.439178, log\_q : 21.367496, KL : 33.687546 (37s)
epoch : 287, eubo : -265.433197, log\_q : 20.684010, KL : 40.706791 (23s)
epoch : 288, eubo : -312.219635, log\_q : 17.180853, KL : 21.653862 (27s)
epoch : 289, eubo : -483.256256, log\_q : 18.023600, KL : 36.033657 (33s)
epoch : 290, eubo : -380.146149, log\_q : 20.472288, KL : 16.247438 (29s)
epoch : 291, eubo : -392.268677, log\_q : 16.406796, KL : 27.812534 (28s)
epoch : 292, eubo : -343.547211, log\_q : 21.327732, KL : 39.691067 (31s)
epoch : 293, eubo : -440.972870, log\_q : 20.282831, KL : 29.773638 (28s)
epoch : 294, eubo : -667.091431, log\_q : 21.549131, KL : 51.605873 (34s)
epoch : 295, eubo : -375.601685, log\_q : 22.742844, KL : 39.720123 (33s)
epoch : 296, eubo : -405.480499, log\_q : 21.304308, KL : 21.071665 (33s)
epoch : 297, eubo : -368.505737, log\_q : 13.339984, KL : 49.686501 (33s)
epoch : 298, eubo : -372.145538, log\_q : 19.023535, KL : 26.754402 (32s)
epoch : 299, eubo : -468.206329, log\_q : 21.245964, KL : 36.146084 (30s)
epoch : 300, eubo : -605.701294, log\_q : 18.445345, KL : 42.447750 (34s)
epoch : 301, eubo : -414.075958, log\_q : 21.343946, KL : 33.043674 (35s)
epoch : 302, eubo : -357.739746, log\_q : 21.636806, KL : 14.917831 (27s)
epoch : 303, eubo : -490.827728, log\_q : 18.927425, KL : 31.694550 (34s)
epoch : 304, eubo : -527.135132, log\_q : 21.432373, KL : 18.927439 (37s)
epoch : 305, eubo : -354.624023, log\_q : 16.219059, KL : 19.250160 (23s)
epoch : 306, eubo : -362.880798, log\_q : 17.290440, KL : 24.381174 (36s)
epoch : 307, eubo : -491.476471, log\_q : 21.812269, KL : 15.951343 (33s)
epoch : 308, eubo : -322.612823, log\_q : 20.797279, KL : 13.378761 (23s)
epoch : 309, eubo : -305.084534, log\_q : 19.480541, KL : 17.946606 (27s)
epoch : 310, eubo : -356.572845, log\_q : 20.200932, KL : 30.924212 (29s)
epoch : 311, eubo : -328.232605, log\_q : 17.815063, KL : 17.697111 (24s)
epoch : 312, eubo : -415.970245, log\_q : 21.923395, KL : 26.719492 (33s)
epoch : 313, eubo : -492.805420, log\_q : 19.615059, KL : 24.157560 (36s)
epoch : 314, eubo : -361.269531, log\_q : 19.784092, KL : 12.348264 (25s)
epoch : 315, eubo : -474.663696, log\_q : 19.691301, KL : 16.502726 (31s)
epoch : 316, eubo : -283.091858, log\_q : 19.114660, KL : 24.036560 (30s)
epoch : 317, eubo : -343.941650, log\_q : 19.615717, KL : 20.605972 (24s)
epoch : 318, eubo : -395.614227, log\_q : 19.508680, KL : 26.236677 (33s)
epoch : 319, eubo : -369.867157, log\_q : 20.284382, KL : 22.571890 (27s)
epoch : 320, eubo : -331.024750, log\_q : 19.084383, KL : 32.625309 (32s)
epoch : 321, eubo : -468.897125, log\_q : 18.366405, KL : 13.818835 (34s)
epoch : 322, eubo : -520.199768, log\_q : 19.620436, KL : 16.169479 (33s)
epoch : 323, eubo : -383.356750, log\_q : 18.894558, KL : 17.284328 (31s)
epoch : 324, eubo : -417.066345, log\_q : 21.262310, KL : 23.856335 (35s)
epoch : 325, eubo : -440.009003, log\_q : 21.452566, KL : 22.477825 (30s)
epoch : 326, eubo : -224.893951, log\_q : 21.013149, KL : 25.769260 (26s)
epoch : 327, eubo : -337.847107, log\_q : 17.256065, KL : 20.583008 (31s)
epoch : 328, eubo : -588.728516, log\_q : 20.724579, KL : 22.093189 (27s)
epoch : 329, eubo : -444.812073, log\_q : 21.634266, KL : 16.830786 (34s)
epoch : 330, eubo : -379.531097, log\_q : 18.343462, KL : 9.794695 (26s)
epoch : 331, eubo : -246.721771, log\_q : 16.648037, KL : 12.599870 (23s)
epoch : 332, eubo : -385.310089, log\_q : 18.490164, KL : 13.711288 (31s)
epoch : 333, eubo : -387.188538, log\_q : 18.321274, KL : 14.568880 (30s)
epoch : 334, eubo : -276.979034, log\_q : 19.683668, KL : 9.126341 (27s)
epoch : 335, eubo : -461.807739, log\_q : 20.742373, KL : 22.757839 (26s)
epoch : 336, eubo : -269.494843, log\_q : 14.070083, KL : 23.282156 (25s)
epoch : 337, eubo : -241.087769, log\_q : 19.549084, KL : 15.952170 (26s)
epoch : 338, eubo : -563.397339, log\_q : 21.520016, KL : 17.625319 (26s)
epoch : 339, eubo : -416.824310, log\_q : 19.501936, KL : 23.260578 (37s)
epoch : 340, eubo : -447.336609, log\_q : 22.473888, KL : 39.628181 (34s)
epoch : 341, eubo : -388.192719, log\_q : 21.937206, KL : 28.526434 (35s)
epoch : 342, eubo : -319.092621, log\_q : 18.653898, KL : 9.016595 (26s)
epoch : 343, eubo : -364.336700, log\_q : 21.459064, KL : 13.953717 (32s)
epoch : 344, eubo : -379.250275, log\_q : 17.392902, KL : 9.000359 (27s)
epoch : 345, eubo : -733.479370, log\_q : 21.922251, KL : 19.316381 (37s)
epoch : 346, eubo : -382.266388, log\_q : 20.271429, KL : 12.349506 (26s)
epoch : 347, eubo : -379.353088, log\_q : 21.049143, KL : 10.164663 (34s)
epoch : 348, eubo : -453.998413, log\_q : 15.045022, KL : 11.949593 (36s)
epoch : 349, eubo : -330.813293, log\_q : 18.807537, KL : 12.680133 (27s)
epoch : 350, eubo : -387.192078, log\_q : 20.338594, KL : 11.634242 (27s)
epoch : 351, eubo : -352.490814, log\_q : 18.169447, KL : 22.699158 (36s)
epoch : 352, eubo : -450.892639, log\_q : 21.093777, KL : 12.628766 (37s)
epoch : 353, eubo : -305.082428, log\_q : 17.323009, KL : 6.933519 (23s)
epoch : 354, eubo : -410.328705, log\_q : 16.860954, KL : 10.257906 (31s)
epoch : 355, eubo : -359.342682, log\_q : 20.421938, KL : 11.289129 (34s)
epoch : 356, eubo : -499.795166, log\_q : 19.790525, KL : 17.392643 (36s)
epoch : 357, eubo : -388.387207, log\_q : 18.599852, KL : 22.903423 (34s)
epoch : 358, eubo : -485.501007, log\_q : 19.067064, KL : 14.035134 (26s)
epoch : 359, eubo : -544.265686, log\_q : 20.452612, KL : 11.809692 (37s)
epoch : 360, eubo : -482.903931, log\_q : 18.616451, KL : 9.551347 (34s)
epoch : 361, eubo : -363.841614, log\_q : 18.780018, KL : 11.053714 (35s)
epoch : 362, eubo : -350.172119, log\_q : 21.003235, KL : 17.836397 (37s)
epoch : 363, eubo : -365.196594, log\_q : 15.520999, KL : 6.628882 (27s)
epoch : 364, eubo : -317.572327, log\_q : 19.966675, KL : 4.888499 (29s)
epoch : 365, eubo : -498.846527, log\_q : 14.919381, KL : 23.227346 (36s)
epoch : 366, eubo : -326.413300, log\_q : 20.220091, KL : 6.693591 (33s)
epoch : 367, eubo : -455.391998, log\_q : 18.822411, KL : 5.514674 (31s)
epoch : 368, eubo : -441.497101, log\_q : 18.412687, KL : 5.480228 (33s)
epoch : 369, eubo : -357.221588, log\_q : 18.599781, KL : 15.739434 (34s)
epoch : 370, eubo : -328.961731, log\_q : 17.942131, KL : 3.800695 (25s)
epoch : 371, eubo : -352.329803, log\_q : 19.225460, KL : 8.141325 (36s)
epoch : 372, eubo : -278.977020, log\_q : 11.413400, KL : 6.116947 (26s)
epoch : 373, eubo : -281.992523, log\_q : 20.267500, KL : 8.420103 (27s)
epoch : 374, eubo : -534.560547, log\_q : 20.155909, KL : 10.701169 (36s)
epoch : 375, eubo : -309.317352, log\_q : 14.697360, KL : 4.963898 (23s)
epoch : 376, eubo : -440.161285, log\_q : 19.649784, KL : 26.580618 (33s)
epoch : 377, eubo : -482.097870, log\_q : 17.761160, KL : 10.472520 (29s)
epoch : 378, eubo : -737.491699, log\_q : 19.877567, KL : 10.259882 (35s)
epoch : 379, eubo : -345.520721, log\_q : 21.334789, KL : 14.001451 (37s)
epoch : 380, eubo : -481.049072, log\_q : 15.534822, KL : 22.212008 (30s)
epoch : 381, eubo : -528.038269, log\_q : 16.749474, KL : 15.036713 (32s)
epoch : 382, eubo : -395.622284, log\_q : 14.021843, KL : 12.505930 (36s)
epoch : 383, eubo : -492.934875, log\_q : 17.116669, KL : 7.154600 (28s)
epoch : 384, eubo : -440.863312, log\_q : 10.707845, KL : 10.372583 (31s)
epoch : 385, eubo : -336.819550, log\_q : 17.445570, KL : 3.948190 (23s)
epoch : 386, eubo : -431.247620, log\_q : 18.499508, KL : 2.993789 (36s)
epoch : 387, eubo : -338.199066, log\_q : 13.110499, KL : 12.324914 (34s)
epoch : 388, eubo : -430.998993, log\_q : 19.289318, KL : 5.307708 (35s)
epoch : 389, eubo : -349.711884, log\_q : 12.670643, KL : 4.721021 (23s)
epoch : 390, eubo : -463.840363, log\_q : 13.867284, KL : 2.947171 (37s)
epoch : 391, eubo : -252.167130, log\_q : 17.794117, KL : 8.288211 (31s)
epoch : 392, eubo : -380.096588, log\_q : 14.671933, KL : 3.636789 (24s)
epoch : 393, eubo : -307.643738, log\_q : 21.388321, KL : 6.166658 (35s)
epoch : 394, eubo : -549.332397, log\_q : 18.540012, KL : 9.322719 (38s)
epoch : 395, eubo : -379.751129, log\_q : 12.778419, KL : 3.757813 (33s)
epoch : 396, eubo : -450.530701, log\_q : 13.794945, KL : 4.128272 (32s)
epoch : 397, eubo : -455.246979, log\_q : 16.673229, KL : 3.383750 (28s)
epoch : 398, eubo : -460.628479, log\_q : 14.433055, KL : 8.194799 (36s)
epoch : 399, eubo : -424.374451, log\_q : 18.090412, KL : 4.180304 (32s)
epoch : 400, eubo : -299.692322, log\_q : 18.576679, KL : 8.377548 (34s)
epoch : 401, eubo : -402.341949, log\_q : 18.451824, KL : 5.239808 (36s)
epoch : 402, eubo : -425.507202, log\_q : 17.162249, KL : 6.317564 (31s)
epoch : 403, eubo : -346.596832, log\_q : 15.946858, KL : 2.882000 (33s)
epoch : 404, eubo : -447.115753, log\_q : 17.014532, KL : 3.594050 (32s)
epoch : 405, eubo : -442.519745, log\_q : 13.365724, KL : 2.613887 (28s)
epoch : 406, eubo : -438.874756, log\_q : 18.611500, KL : 5.696936 (37s)
epoch : 407, eubo : -322.999969, log\_q : 19.431580, KL : 3.063174 (37s)
epoch : 408, eubo : -512.970581, log\_q : 18.623652, KL : 3.884037 (35s)
epoch : 409, eubo : -426.040588, log\_q : 16.810259, KL : 2.923308 (27s)
epoch : 410, eubo : -368.423279, log\_q : 15.815863, KL : 2.062792 (37s)
epoch : 411, eubo : -350.784180, log\_q : 17.126326, KL : 3.260013 (27s)
epoch : 412, eubo : -418.510864, log\_q : 17.678431, KL : 2.881902 (28s)
epoch : 413, eubo : -593.648926, log\_q : 15.688575, KL : 6.721863 (31s)
epoch : 414, eubo : -407.220459, log\_q : 17.626780, KL : 2.886126 (27s)
epoch : 415, eubo : -280.586792, log\_q : 18.236086, KL : 1.751290 (26s)
epoch : 416, eubo : -425.466888, log\_q : 17.164234, KL : 3.768620 (36s)
epoch : 417, eubo : -314.858063, log\_q : 18.041101, KL : 2.904195 (27s)
epoch : 418, eubo : -314.524323, log\_q : 15.801782, KL : 1.712329 (25s)
epoch : 419, eubo : -435.117035, log\_q : 16.948711, KL : 3.541775 (29s)
epoch : 420, eubo : -493.544495, log\_q : 17.738724, KL : 3.518732 (35s)
epoch : 421, eubo : -253.819611, log\_q : 11.964756, KL : 5.510839 (24s)
epoch : 422, eubo : -456.261871, log\_q : 17.425827, KL : 1.650756 (45s)
epoch : 423, eubo : -279.543579, log\_q : 16.533222, KL : 4.628646 (33s)
epoch : 424, eubo : -395.252472, log\_q : 15.214978, KL : 2.638931 (27s)
epoch : 425, eubo : -454.305786, log\_q : 18.945879, KL : 6.887188 (34s)
epoch : 426, eubo : -424.415558, log\_q : 16.198389, KL : 1.167195 (36s)
epoch : 427, eubo : -418.765839, log\_q : 18.874857, KL : 9.252146 (34s)
epoch : 428, eubo : -530.523010, log\_q : 18.387411, KL : 3.080941 (34s)
epoch : 429, eubo : -425.983398, log\_q : 17.261023, KL : 1.993826 (35s)
epoch : 430, eubo : -357.287506, log\_q : 15.304766, KL : 4.238794 (24s)
epoch : 431, eubo : -298.515503, log\_q : 18.217707, KL : 4.128421 (30s)
epoch : 432, eubo : -292.420319, log\_q : 14.879277, KL : 3.432411 (23s)
epoch : 433, eubo : -330.171967, log\_q : 13.896170, KL : 3.595699 (24s)
epoch : 434, eubo : -501.223480, log\_q : 16.949610, KL : 2.743415 (27s)
epoch : 435, eubo : -362.403717, log\_q : 17.335072, KL : 2.145976 (36s)
epoch : 436, eubo : -478.385590, log\_q : 17.687283, KL : 1.325245 (35s)
epoch : 437, eubo : -553.895935, log\_q : 15.939879, KL : 3.028703 (37s)
epoch : 438, eubo : -350.533813, log\_q : 15.021014, KL : 3.178701 (26s)
epoch : 439, eubo : -319.769867, log\_q : 15.606284, KL : 1.308331 (23s)
epoch : 440, eubo : -289.126801, log\_q : 13.917590, KL : 5.625964 (25s)
epoch : 441, eubo : -283.699890, log\_q : 17.543703, KL : 6.827827 (28s)
epoch : 442, eubo : -371.545929, log\_q : 16.971474, KL : 1.856501 (26s)
epoch : 443, eubo : -454.489319, log\_q : 17.656544, KL : 3.287869 (37s)
epoch : 444, eubo : -474.517487, log\_q : 17.105999, KL : 2.880829 (35s)
epoch : 445, eubo : -314.755737, log\_q : 16.538757, KL : 1.041193 (24s)
epoch : 446, eubo : -379.118835, log\_q : 14.667166, KL : 4.530910 (28s)
epoch : 447, eubo : -280.461700, log\_q : 13.572008, KL : 2.531742 (27s)
epoch : 448, eubo : -433.653015, log\_q : 16.465754, KL : 1.495548 (26s)
epoch : 449, eubo : -293.450806, log\_q : 17.290300, KL : 5.025535 (31s)
epoch : 450, eubo : -449.066589, log\_q : 16.620461, KL : 3.125984 (33s)
epoch : 451, eubo : -345.243073, log\_q : 16.694847, KL : 1.401482 (28s)
epoch : 452, eubo : -382.400269, log\_q : 17.419538, KL : 2.687866 (37s)
epoch : 453, eubo : -380.160980, log\_q : 16.182322, KL : 2.520524 (30s)
epoch : 454, eubo : -391.964050, log\_q : 16.215128, KL : 2.435551 (33s)
epoch : 455, eubo : -308.652802, log\_q : 17.094458, KL : 2.880529 (29s)
epoch : 456, eubo : -441.545776, log\_q : 16.579712, KL : 3.471720 (36s)
epoch : 457, eubo : -599.912964, log\_q : 16.617586, KL : 2.384999 (30s)
epoch : 458, eubo : -403.032257, log\_q : 16.323462, KL : 2.179864 (38s)
epoch : 459, eubo : -355.062744, log\_q : 17.694546, KL : 2.454024 (37s)
epoch : 460, eubo : -473.792633, log\_q : 15.131069, KL : 2.924666 (28s)
epoch : 461, eubo : -453.538513, log\_q : 17.070154, KL : 7.234182 (37s)
epoch : 462, eubo : -345.216858, log\_q : 16.667995, KL : 1.605564 (33s)
epoch : 463, eubo : -387.845978, log\_q : 16.474272, KL : 5.776403 (35s)
epoch : 464, eubo : -357.995850, log\_q : 17.694691, KL : 2.163316 (34s)
epoch : 465, eubo : -401.397858, log\_q : 16.493336, KL : 2.849470 (36s)
epoch : 466, eubo : -514.323059, log\_q : 19.891329, KL : 5.213305 (31s)
epoch : 467, eubo : -557.023560, log\_q : 19.242050, KL : 2.467001 (31s)
epoch : 468, eubo : -433.168610, log\_q : 15.766481, KL : 2.147700 (31s)
epoch : 469, eubo : -372.833618, log\_q : 15.538762, KL : 5.590796 (34s)
epoch : 470, eubo : -369.975677, log\_q : 17.305687, KL : 4.059117 (28s)
epoch : 471, eubo : -435.964996, log\_q : 18.959719, KL : 1.814160 (27s)
epoch : 472, eubo : -456.708740, log\_q : 11.802274, KL : 2.851729 (34s)
epoch : 473, eubo : -339.351135, log\_q : 15.657198, KL : 1.889515 (35s)
epoch : 474, eubo : -431.103760, log\_q : 17.167006, KL : 1.599606 (32s)
epoch : 475, eubo : -496.286896, log\_q : 17.735153, KL : 1.860676 (31s)
epoch : 476, eubo : -425.055878, log\_q : 19.764942, KL : 4.376953 (29s)
epoch : 477, eubo : -330.854797, log\_q : 16.437847, KL : 1.384497 (30s)
epoch : 478, eubo : -407.505188, log\_q : 17.051256, KL : 2.918420 (25s)
epoch : 479, eubo : -410.917633, log\_q : 16.754635, KL : 2.655358 (35s)
epoch : 480, eubo : -446.368744, log\_q : 16.006084, KL : 4.402454 (29s)
epoch : 481, eubo : -516.599487, log\_q : 18.125772, KL : 1.903728 (36s)
epoch : 482, eubo : -597.281616, log\_q : 17.172300, KL : 2.777062 (37s)
epoch : 483, eubo : -441.206573, log\_q : 16.116585, KL : 1.808226 (23s)
epoch : 484, eubo : -419.530090, log\_q : 15.689428, KL : 6.649328 (32s)
epoch : 485, eubo : -300.763824, log\_q : 15.252150, KL : 3.348765 (24s)
epoch : 486, eubo : -455.400116, log\_q : 15.003153, KL : 3.273000 (35s)
epoch : 487, eubo : -480.283783, log\_q : 17.677368, KL : 5.801852 (37s)
epoch : 488, eubo : -220.930252, log\_q : 16.667215, KL : 1.485431 (24s)
epoch : 489, eubo : -459.307739, log\_q : 14.091442, KL : 1.937823 (28s)
epoch : 490, eubo : -356.467133, log\_q : 17.504108, KL : 3.736070 (32s)
epoch : 491, eubo : -323.509308, log\_q : 14.371075, KL : 3.343103 (33s)
epoch : 492, eubo : -402.286591, log\_q : 16.159990, KL : 2.158293 (24s)
epoch : 493, eubo : -468.422638, log\_q : 17.888702, KL : 2.823797 (36s)
epoch : 494, eubo : -298.398682, log\_q : 16.505960, KL : 3.068877 (30s)
epoch : 495, eubo : -437.883118, log\_q : 18.914946, KL : 1.088502 (29s)
epoch : 496, eubo : -427.315155, log\_q : 15.611534, KL : 1.720758 (29s)
epoch : 497, eubo : -368.123810, log\_q : 18.207497, KL : 1.221964 (31s)
epoch : 498, eubo : -333.948822, log\_q : 19.005093, KL : 1.464772 (31s)
epoch : 499, eubo : -353.190735, log\_q : 13.710249, KL : 1.825652 (23s)
epoch : 500, eubo : -525.604431, log\_q : 15.711266, KL : 4.011764 (37s)
epoch : 501, eubo : -325.081329, log\_q : 16.382650, KL : 2.387788 (27s)
epoch : 502, eubo : -387.082703, log\_q : 16.534193, KL : 2.958290 (26s)
epoch : 503, eubo : -440.471497, log\_q : 14.526194, KL : 1.602651 (23s)
epoch : 504, eubo : -443.034637, log\_q : 17.976496, KL : 4.686918 (38s)
epoch : 505, eubo : -370.236633, log\_q : 16.008219, KL : 2.323745 (30s)
epoch : 506, eubo : -285.573822, log\_q : 18.420843, KL : 1.976478 (33s)
epoch : 507, eubo : -320.179626, log\_q : 17.163750, KL : 6.308599 (36s)
epoch : 508, eubo : -556.564087, log\_q : 19.315420, KL : 6.069984 (36s)
epoch : 509, eubo : -470.770477, log\_q : 16.865841, KL : 1.378783 (28s)
epoch : 510, eubo : -249.859833, log\_q : 10.201568, KL : 4.287561 (24s)
epoch : 511, eubo : -266.167938, log\_q : 15.695473, KL : 5.225163 (24s)
epoch : 512, eubo : -295.298248, log\_q : 18.052536, KL : 5.424294 (30s)
epoch : 513, eubo : -338.495789, log\_q : 18.668026, KL : 2.020314 (27s)
epoch : 514, eubo : -307.092773, log\_q : 13.012752, KL : 3.302228 (25s)
epoch : 515, eubo : -436.899353, log\_q : 15.681633, KL : 4.144812 (33s)
epoch : 516, eubo : -450.316864, log\_q : 17.902494, KL : 5.600819 (35s)
epoch : 517, eubo : -371.609100, log\_q : 17.291664, KL : 2.186891 (34s)
epoch : 518, eubo : -329.582397, log\_q : 18.086199, KL : 2.051011 (34s)
epoch : 519, eubo : -315.705627, log\_q : 16.457575, KL : 2.404074 (27s)
epoch : 520, eubo : -592.440613, log\_q : 18.042091, KL : 2.065568 (36s)
epoch : 521, eubo : -379.440979, log\_q : 16.721508, KL : 2.596226 (30s)
epoch : 522, eubo : -300.654816, log\_q : 16.174112, KL : 3.799082 (28s)
epoch : 523, eubo : -310.960114, log\_q : 15.043504, KL : 2.934278 (23s)
epoch : 524, eubo : -358.198059, log\_q : 20.190144, KL : 1.201391 (33s)
epoch : 525, eubo : -424.257782, log\_q : 16.282251, KL : 3.940029 (35s)
epoch : 526, eubo : -491.948090, log\_q : 18.472288, KL : 1.607840 (35s)
epoch : 527, eubo : -221.459839, log\_q : 15.041506, KL : 2.674424 (27s)
epoch : 528, eubo : -427.533417, log\_q : 14.469998, KL : 2.726743 (29s)
epoch : 529, eubo : -241.046021, log\_q : 16.986853, KL : 2.262732 (26s)
epoch : 530, eubo : -318.921539, log\_q : 17.271574, KL : 5.212545 (33s)
epoch : 531, eubo : -321.240936, log\_q : 14.441686, KL : 1.599532 (28s)
epoch : 532, eubo : -424.604309, log\_q : 17.627613, KL : 2.311502 (31s)
epoch : 533, eubo : -303.648346, log\_q : 14.338201, KL : 2.455370 (25s)
epoch : 534, eubo : -396.056580, log\_q : 15.422655, KL : 2.024945 (36s)
epoch : 535, eubo : -294.891022, log\_q : 15.616531, KL : 4.159385 (30s)
epoch : 536, eubo : -338.477692, log\_q : 15.956231, KL : 4.413210 (35s)
epoch : 537, eubo : -260.986420, log\_q : 16.886255, KL : 1.951843 (25s)
epoch : 538, eubo : -363.795166, log\_q : 16.512569, KL : 2.106549 (29s)
epoch : 539, eubo : -402.455566, log\_q : 13.876758, KL : 1.637184 (37s)
epoch : 540, eubo : -282.034851, log\_q : 12.338480, KL : 3.916389 (25s)
epoch : 541, eubo : -414.212036, log\_q : 15.517199, KL : 1.606753 (29s)
epoch : 542, eubo : -437.860809, log\_q : 14.837386, KL : 1.795679 (24s)
epoch : 543, eubo : -344.715485, log\_q : 16.653313, KL : 1.130366 (32s)
epoch : 544, eubo : -401.740448, log\_q : 16.468521, KL : 0.813617 (32s)
epoch : 545, eubo : -383.313934, log\_q : 17.950260, KL : 1.786461 (31s)
epoch : 546, eubo : -497.606140, log\_q : 13.592440, KL : 2.578549 (24s)
epoch : 547, eubo : -572.517395, log\_q : 17.004843, KL : 6.860774 (37s)
epoch : 548, eubo : -390.257202, log\_q : 16.996483, KL : 1.910514 (30s)
epoch : 549, eubo : -324.545105, log\_q : 17.132677, KL : 2.188605 (30s)
epoch : 550, eubo : -438.243134, log\_q : 16.094473, KL : 1.759273 (26s)
epoch : 551, eubo : -291.045319, log\_q : 11.071004, KL : 3.895476 (23s)
epoch : 552, eubo : -399.958160, log\_q : 18.854218, KL : 1.712833 (32s)
epoch : 553, eubo : -500.263153, log\_q : 15.044109, KL : 4.865772 (37s)
epoch : 554, eubo : -478.843262, log\_q : 16.462370, KL : 1.328600 (30s)
epoch : 555, eubo : -399.749237, log\_q : 17.395813, KL : 1.457977 (31s)
epoch : 556, eubo : -538.650757, log\_q : 17.745142, KL : 3.711970 (29s)
epoch : 557, eubo : -386.211060, log\_q : 14.921256, KL : 1.690881 (26s)
epoch : 558, eubo : -373.647614, log\_q : 16.126173, KL : 1.446216 (32s)
epoch : 559, eubo : -368.652863, log\_q : 15.897524, KL : 1.610945 (25s)
epoch : 560, eubo : -355.855225, log\_q : 13.322163, KL : 2.413031 (24s)
epoch : 561, eubo : -562.543518, log\_q : 17.471031, KL : 1.763889 (30s)
epoch : 562, eubo : -457.602417, log\_q : 17.411537, KL : 0.821561 (33s)
epoch : 563, eubo : -330.435364, log\_q : 17.832603, KL : 2.116899 (24s)
epoch : 564, eubo : -353.276672, log\_q : 15.796447, KL : 1.810150 (25s)
epoch : 565, eubo : -385.178070, log\_q : 17.364590, KL : 1.057977 (35s)
epoch : 566, eubo : -291.966461, log\_q : 17.067240, KL : 5.380987 (36s)
epoch : 567, eubo : -674.596924, log\_q : 15.770150, KL : 2.625554 (32s)
epoch : 568, eubo : -339.653870, log\_q : 14.320015, KL : 2.768961 (23s)
epoch : 569, eubo : -235.949295, log\_q : 16.228035, KL : 2.976725 (30s)
epoch : 570, eubo : -351.059265, log\_q : 18.145433, KL : 2.693534 (37s)
epoch : 571, eubo : -492.244904, log\_q : 14.960814, KL : 2.079578 (37s)
epoch : 572, eubo : -378.920319, log\_q : 17.374563, KL : 1.670091 (31s)
epoch : 573, eubo : -368.387146, log\_q : 16.222372, KL : 1.131903 (35s)
epoch : 574, eubo : -403.907043, log\_q : 14.253527, KL : 1.538820 (27s)
epoch : 575, eubo : -299.346741, log\_q : 14.722492, KL : 2.078620 (24s)
epoch : 576, eubo : -252.679306, log\_q : 16.964121, KL : 3.898225 (31s)
epoch : 577, eubo : -427.505249, log\_q : 17.270477, KL : 1.600585 (33s)
epoch : 578, eubo : -340.563538, log\_q : 14.858586, KL : 2.865490 (34s)
epoch : 579, eubo : -420.776581, log\_q : 13.566075, KL : 3.105753 (36s)
epoch : 580, eubo : -400.501312, log\_q : 18.494812, KL : 1.638687 (32s)
epoch : 581, eubo : -568.892334, log\_q : 15.186661, KL : 3.442285 (37s)
epoch : 582, eubo : -301.586884, log\_q : 15.082247, KL : 1.875937 (24s)
epoch : 583, eubo : -375.676758, log\_q : 16.908705, KL : 2.573215 (30s)
epoch : 584, eubo : -673.531860, log\_q : 17.197290, KL : 3.884117 (27s)
epoch : 585, eubo : -439.863007, log\_q : 17.017588, KL : 1.414383 (32s)
epoch : 586, eubo : -448.639893, log\_q : 17.197531, KL : 1.826711 (33s)
epoch : 587, eubo : -636.272583, log\_q : 14.999475, KL : 3.183405 (35s)
epoch : 588, eubo : -430.355499, log\_q : 15.965838, KL : 1.842445 (31s)
epoch : 589, eubo : -484.780121, log\_q : 17.406260, KL : 4.380364 (38s)
epoch : 590, eubo : -365.283417, log\_q : 15.678658, KL : 5.001217 (36s)
epoch : 591, eubo : -326.458740, log\_q : 15.145353, KL : 4.033976 (23s)
epoch : 592, eubo : -374.680511, log\_q : 15.742985, KL : 2.055090 (33s)
epoch : 593, eubo : -390.213196, log\_q : 16.736290, KL : 1.202353 (31s)
epoch : 594, eubo : -315.475800, log\_q : 15.559849, KL : 3.586342 (27s)
epoch : 595, eubo : -483.181427, log\_q : 14.042444, KL : 5.472894 (35s)
epoch : 596, eubo : -402.640350, log\_q : 12.513104, KL : 2.674283 (27s)
epoch : 597, eubo : -327.458527, log\_q : 15.890240, KL : 1.043102 (34s)
epoch : 598, eubo : -378.721100, log\_q : 17.425869, KL : 5.891629 (31s)
epoch : 599, eubo : -554.316711, log\_q : 19.284014, KL : 3.165127 (37s)
epoch : 600, eubo : -462.749573, log\_q : 15.917271, KL : 5.141581 (33s)
epoch : 601, eubo : -456.958862, log\_q : 17.705072, KL : 1.592729 (32s)
epoch : 602, eubo : -413.900696, log\_q : 18.256155, KL : 6.957480 (38s)
epoch : 603, eubo : -385.374146, log\_q : 17.028311, KL : 3.624414 (36s)
epoch : 604, eubo : -317.826813, log\_q : 16.530863, KL : 1.671426 (33s)
epoch : 605, eubo : -263.029572, log\_q : 16.090691, KL : 2.290021 (30s)
epoch : 606, eubo : -369.622772, log\_q : 17.001989, KL : 2.730771 (31s)
epoch : 607, eubo : -498.546265, log\_q : 13.093863, KL : 3.569830 (33s)
epoch : 608, eubo : -409.496674, log\_q : 17.119118, KL : 3.552179 (31s)
epoch : 609, eubo : -598.004517, log\_q : 14.403272, KL : 4.990869 (34s)
epoch : 610, eubo : -463.298401, log\_q : 16.191748, KL : 2.547887 (27s)
epoch : 611, eubo : -284.422668, log\_q : 16.778885, KL : 1.301817 (24s)
epoch : 612, eubo : -374.160583, log\_q : 18.093296, KL : 2.212014 (27s)
epoch : 613, eubo : -428.151825, log\_q : 15.695604, KL : 1.844219 (32s)
epoch : 614, eubo : -360.298981, log\_q : 12.553940, KL : 2.698810 (29s)
epoch : 615, eubo : -335.802643, log\_q : 16.496040, KL : 1.710905 (32s)
epoch : 616, eubo : -388.231110, log\_q : 18.611200, KL : 4.726064 (35s)
epoch : 617, eubo : -411.729462, log\_q : 16.036610, KL : 2.481399 (32s)
epoch : 618, eubo : -551.360535, log\_q : 15.279779, KL : 1.614099 (30s)
epoch : 619, eubo : -483.725891, log\_q : 16.235659, KL : 3.599387 (37s)
epoch : 620, eubo : -613.284851, log\_q : 16.165413, KL : 1.582166 (29s)
epoch : 621, eubo : -555.276306, log\_q : 14.885662, KL : 3.827908 (27s)
epoch : 622, eubo : -339.024109, log\_q : 16.885626, KL : 1.434635 (30s)
epoch : 623, eubo : -329.685211, log\_q : 16.840620, KL : 2.782845 (28s)
epoch : 624, eubo : -283.215820, log\_q : 13.878339, KL : 2.659533 (23s)
epoch : 625, eubo : -391.196899, log\_q : 15.963326, KL : 1.320124 (37s)
epoch : 626, eubo : -329.691284, log\_q : 14.126808, KL : 1.572123 (29s)
epoch : 627, eubo : -406.883575, log\_q : 17.296591, KL : 2.781075 (36s)
epoch : 628, eubo : -429.348694, log\_q : 16.375660, KL : 2.057887 (29s)
epoch : 629, eubo : -381.658173, log\_q : 16.199051, KL : 1.793880 (31s)
epoch : 630, eubo : -332.129364, log\_q : 15.456728, KL : 5.264297 (33s)
epoch : 631, eubo : -326.896210, log\_q : 18.250006, KL : 1.911467 (28s)
epoch : 632, eubo : -430.582428, log\_q : 15.862369, KL : 2.929024 (34s)
epoch : 633, eubo : -362.397583, log\_q : 16.252617, KL : 1.544153 (27s)
epoch : 634, eubo : -283.000763, log\_q : 16.235580, KL : 2.240229 (26s)
epoch : 635, eubo : -333.241364, log\_q : 16.499161, KL : 1.705344 (27s)
epoch : 636, eubo : -372.254333, log\_q : 16.848627, KL : 1.022680 (29s)
epoch : 637, eubo : -341.321777, log\_q : 16.519232, KL : 1.215929 (28s)
epoch : 638, eubo : -457.122406, log\_q : 16.050627, KL : 2.594414 (32s)
epoch : 639, eubo : -352.090973, log\_q : 13.998629, KL : 3.043811 (29s)
epoch : 640, eubo : -477.735535, log\_q : 17.315004, KL : 2.122774 (35s)
epoch : 641, eubo : -447.337677, log\_q : 18.441235, KL : 2.020677 (33s)
epoch : 642, eubo : -300.163422, log\_q : 16.553596, KL : 2.093483 (24s)
epoch : 643, eubo : -418.339142, log\_q : 13.047154, KL : 7.816794 (36s)
epoch : 644, eubo : -371.612427, log\_q : 16.589975, KL : 1.712961 (28s)
epoch : 645, eubo : -449.214630, log\_q : 17.841097, KL : 1.608615 (35s)
epoch : 646, eubo : -261.077057, log\_q : 15.389923, KL : 2.852154 (27s)
epoch : 647, eubo : -278.907776, log\_q : 14.973394, KL : 1.454130 (25s)
epoch : 648, eubo : -288.556061, log\_q : 17.780722, KL : 1.152009 (36s)
epoch : 649, eubo : -433.303345, log\_q : 15.379210, KL : 1.503665 (24s)
epoch : 650, eubo : -712.520874, log\_q : 16.656839, KL : 4.508605 (31s)
epoch : 651, eubo : -354.631317, log\_q : 17.216745, KL : 0.998675 (27s)
epoch : 652, eubo : -370.998657, log\_q : 16.154697, KL : 2.950917 (30s)
epoch : 653, eubo : -501.822693, log\_q : 16.021591, KL : 2.924947 (33s)
epoch : 654, eubo : -428.488281, log\_q : 16.543301, KL : 2.650434 (36s)
epoch : 655, eubo : -381.808502, log\_q : 17.211325, KL : 4.347324 (35s)
epoch : 656, eubo : -343.958862, log\_q : 14.245772, KL : 8.860507 (37s)
epoch : 657, eubo : -364.534698, log\_q : 15.398220, KL : 1.726363 (27s)
epoch : 658, eubo : -394.150330, log\_q : 16.292179, KL : 1.381682 (25s)
epoch : 659, eubo : -417.854462, log\_q : 17.231060, KL : 2.450867 (34s)
epoch : 660, eubo : -418.390594, log\_q : 15.557750, KL : 2.624834 (28s)
epoch : 661, eubo : -347.426910, log\_q : 16.909418, KL : 1.747304 (35s)
epoch : 662, eubo : -365.910950, log\_q : 15.486712, KL : 2.027809 (26s)
epoch : 663, eubo : -272.859436, log\_q : 15.927890, KL : 0.960820 (23s)
epoch : 664, eubo : -441.702209, log\_q : 18.447298, KL : 2.397752 (35s)
epoch : 665, eubo : -259.482086, log\_q : 14.995244, KL : 2.876602 (24s)
epoch : 666, eubo : -358.254028, log\_q : 17.337521, KL : 4.977783 (35s)
epoch : 667, eubo : -298.302734, log\_q : 16.955774, KL : 3.357563 (36s)
epoch : 668, eubo : -275.624054, log\_q : 12.779984, KL : 6.797311 (35s)
epoch : 669, eubo : -373.800995, log\_q : 16.977865, KL : 1.372875 (32s)
epoch : 670, eubo : -380.520142, log\_q : 14.188230, KL : 1.812260 (35s)
epoch : 671, eubo : -412.269470, log\_q : 16.605156, KL : 5.569970 (31s)
epoch : 672, eubo : -328.609070, log\_q : 17.297787, KL : 1.288172 (24s)
epoch : 673, eubo : -339.088043, log\_q : 16.508648, KL : 2.817723 (25s)
epoch : 674, eubo : -325.594360, log\_q : 16.160385, KL : 2.199219 (26s)
epoch : 675, eubo : -316.472961, log\_q : 16.099974, KL : 1.501529 (28s)
epoch : 676, eubo : -259.120636, log\_q : 14.910412, KL : 1.395230 (26s)
epoch : 677, eubo : -570.344177, log\_q : 14.175253, KL : 5.687720 (34s)
epoch : 678, eubo : -381.486023, log\_q : 14.769387, KL : 1.609276 (30s)
epoch : 679, eubo : -456.296539, log\_q : 18.275597, KL : 1.222016 (38s)
epoch : 680, eubo : -453.845703, log\_q : 18.004288, KL : 2.901315 (34s)
epoch : 681, eubo : -293.072388, log\_q : 12.759607, KL : 10.086326 (36s)
epoch : 682, eubo : -445.732147, log\_q : 16.937784, KL : 2.480037 (27s)
epoch : 683, eubo : -272.657288, log\_q : 13.864651, KL : 3.651236 (27s)
epoch : 684, eubo : -457.901459, log\_q : 18.401474, KL : 2.984276 (38s)
epoch : 685, eubo : -562.531738, log\_q : 19.264351, KL : 2.175829 (35s)
epoch : 686, eubo : -304.779358, log\_q : 15.351508, KL : 1.968749 (30s)
epoch : 687, eubo : -370.338867, log\_q : 16.402111, KL : 2.695092 (30s)
epoch : 688, eubo : -522.669373, log\_q : 17.359800, KL : 3.413050 (33s)
epoch : 689, eubo : -421.591003, log\_q : 15.423767, KL : 3.847238 (34s)
epoch : 690, eubo : -422.834473, log\_q : 14.441191, KL : 0.901256 (28s)
epoch : 691, eubo : -508.031799, log\_q : 14.922308, KL : 2.174241 (34s)
epoch : 692, eubo : -441.276764, log\_q : 17.346479, KL : 3.917276 (34s)
epoch : 693, eubo : -429.573578, log\_q : 17.028402, KL : 1.559779 (26s)
epoch : 694, eubo : -335.268585, log\_q : 13.425005, KL : 1.449533 (25s)
epoch : 695, eubo : -266.874207, log\_q : 16.396830, KL : 3.010363 (25s)
epoch : 696, eubo : -400.172791, log\_q : 12.506688, KL : 1.673385 (37s)
epoch : 697, eubo : -459.413239, log\_q : 17.146879, KL : 2.040719 (31s)
epoch : 698, eubo : -344.984741, log\_q : 15.203460, KL : 1.728655 (26s)
epoch : 699, eubo : -381.500336, log\_q : 17.059908, KL : 0.492197 (38s)
epoch : 700, eubo : -440.194763, log\_q : 14.562143, KL : 3.106673 (30s)
epoch : 701, eubo : -310.009491, log\_q : 14.599386, KL : 5.747262 (32s)
epoch : 702, eubo : -460.401520, log\_q : 18.058126, KL : 4.122935 (36s)
epoch : 703, eubo : -367.010498, log\_q : 18.330999, KL : 2.977826 (29s)
epoch : 704, eubo : -385.677063, log\_q : 16.596220, KL : 1.704695 (24s)
epoch : 705, eubo : -339.465118, log\_q : 16.557322, KL : 2.015746 (30s)
epoch : 706, eubo : -343.712677, log\_q : 18.468454, KL : 3.378693 (36s)
epoch : 707, eubo : -378.007843, log\_q : 16.983019, KL : 1.271176 (34s)
epoch : 708, eubo : -435.660828, log\_q : 14.913614, KL : 2.195626 (35s)
epoch : 709, eubo : -405.116852, log\_q : 15.762558, KL : 2.982506 (34s)
epoch : 710, eubo : -432.590332, log\_q : 17.768105, KL : 1.447077 (25s)
epoch : 711, eubo : -397.181244, log\_q : 14.228494, KL : 2.250202 (28s)
epoch : 712, eubo : -378.563873, log\_q : 18.404531, KL : 2.321192 (27s)
epoch : 713, eubo : -355.458496, log\_q : 13.970083, KL : 4.842892 (28s)
epoch : 714, eubo : -493.462799, log\_q : 17.240602, KL : 2.593270 (37s)
epoch : 715, eubo : -377.652039, log\_q : 15.108081, KL : 7.062582 (32s)
epoch : 716, eubo : -371.856415, log\_q : 12.900528, KL : 4.273349 (31s)
epoch : 717, eubo : -284.526611, log\_q : 16.198763, KL : 1.831414 (23s)
epoch : 718, eubo : -400.172546, log\_q : 18.370567, KL : 1.045214 (34s)
epoch : 719, eubo : -395.420319, log\_q : 16.545824, KL : 1.449764 (29s)
epoch : 720, eubo : -336.759979, log\_q : 16.751083, KL : 2.777982 (32s)
epoch : 721, eubo : -367.770020, log\_q : 16.263395, KL : 1.085951 (30s)
epoch : 722, eubo : -372.132477, log\_q : 13.321071, KL : 2.397621 (26s)
epoch : 723, eubo : -548.165405, log\_q : 13.896624, KL : 3.474168 (30s)
epoch : 724, eubo : -365.205017, log\_q : 16.851780, KL : 2.169637 (28s)
epoch : 725, eubo : -327.726166, log\_q : 17.498354, KL : 3.793202 (33s)
epoch : 726, eubo : -309.374512, log\_q : 16.788042, KL : 2.156297 (27s)
epoch : 727, eubo : -345.478729, log\_q : 16.449411, KL : 4.240016 (34s)
epoch : 728, eubo : -571.510498, log\_q : 15.707300, KL : 3.093614 (29s)
epoch : 729, eubo : -450.744385, log\_q : 17.345446, KL : 3.579833 (34s)
epoch : 730, eubo : -405.918427, log\_q : 15.975801, KL : 2.298223 (30s)
epoch : 731, eubo : -423.608246, log\_q : 15.670054, KL : 3.157000 (28s)
epoch : 732, eubo : -353.552307, log\_q : 14.767985, KL : 4.480705 (31s)
epoch : 733, eubo : -317.858276, log\_q : 15.586840, KL : 2.078665 (27s)
epoch : 734, eubo : -286.583832, log\_q : 18.544212, KL : 5.231183 (30s)
epoch : 735, eubo : -344.222504, log\_q : 15.380117, KL : 3.261295 (29s)
epoch : 736, eubo : -335.666382, log\_q : 15.517220, KL : 1.765060 (26s)
epoch : 737, eubo : -274.894379, log\_q : 17.305243, KL : 1.332801 (24s)
epoch : 738, eubo : -308.761810, log\_q : 17.182247, KL : 1.740685 (26s)
epoch : 739, eubo : -478.358246, log\_q : 17.328812, KL : 2.048506 (37s)
epoch : 740, eubo : -464.505676, log\_q : 18.892963, KL : 1.575495 (35s)
epoch : 741, eubo : -313.804413, log\_q : 16.425594, KL : 3.374351 (28s)
epoch : 742, eubo : -323.154694, log\_q : 16.181986, KL : 3.472402 (25s)
epoch : 743, eubo : -554.796997, log\_q : 14.068806, KL : 3.033799 (33s)
epoch : 744, eubo : -344.784882, log\_q : 14.139359, KL : 1.976541 (28s)
epoch : 745, eubo : -306.822998, log\_q : 16.306335, KL : 3.386664 (34s)
epoch : 746, eubo : -301.929108, log\_q : 18.170687, KL : 1.600127 (27s)
epoch : 747, eubo : -426.432526, log\_q : 17.574163, KL : 1.917239 (35s)
epoch : 748, eubo : -485.948181, log\_q : 10.981654, KL : 1.988529 (32s)
epoch : 749, eubo : -405.601593, log\_q : 18.299826, KL : 1.805042 (25s)
epoch : 750, eubo : -503.344177, log\_q : 18.664705, KL : 1.681880 (38s)
epoch : 751, eubo : -515.391602, log\_q : 15.980808, KL : 2.492434 (35s)
epoch : 752, eubo : -270.426849, log\_q : 16.602846, KL : 4.149687 (33s)
epoch : 753, eubo : -404.648895, log\_q : 16.123024, KL : 1.853905 (28s)
epoch : 754, eubo : -522.193848, log\_q : 18.401773, KL : 2.147464 (35s)
epoch : 755, eubo : -328.884094, log\_q : 16.300915, KL : 1.524591 (27s)
epoch : 756, eubo : -265.911774, log\_q : 17.813065, KL : 3.189412 (33s)
epoch : 757, eubo : -624.660034, log\_q : 14.656780, KL : 2.633836 (30s)
epoch : 758, eubo : -463.435791, log\_q : 16.930414, KL : 1.634189 (33s)
epoch : 759, eubo : -302.990540, log\_q : 16.077271, KL : 2.175665 (23s)
epoch : 760, eubo : -380.461060, log\_q : 17.450188, KL : 3.216388 (33s)
epoch : 761, eubo : -348.607147, log\_q : 14.608292, KL : 2.312384 (23s)
epoch : 762, eubo : -313.443420, log\_q : 15.554147, KL : 1.823488 (25s)
epoch : 763, eubo : -500.229187, log\_q : 14.245420, KL : 2.534126 (24s)
epoch : 764, eubo : -318.803253, log\_q : 17.262863, KL : 1.424492 (26s)
epoch : 765, eubo : -397.541412, log\_q : 15.981204, KL : 0.879053 (32s)
epoch : 766, eubo : -308.678497, log\_q : 16.710974, KL : 0.681418 (32s)
epoch : 767, eubo : -444.794708, log\_q : 16.223192, KL : 2.069889 (36s)
epoch : 768, eubo : -448.489044, log\_q : 15.721578, KL : 1.905404 (32s)
epoch : 769, eubo : -328.437317, log\_q : 15.231979, KL : 1.521466 (24s)
epoch : 770, eubo : -268.409668, log\_q : 16.114714, KL : 1.069346 (28s)
epoch : 771, eubo : -351.861511, log\_q : 15.739368, KL : 2.951568 (28s)
epoch : 772, eubo : -302.822296, log\_q : 15.663153, KL : 3.050355 (26s)
epoch : 773, eubo : -401.568176, log\_q : 17.072739, KL : 2.768711 (38s)
epoch : 774, eubo : -484.690094, log\_q : 14.665913, KL : 5.990423 (36s)
epoch : 775, eubo : -601.625793, log\_q : 17.035957, KL : 4.011763 (38s)
epoch : 776, eubo : -298.027008, log\_q : 14.879832, KL : 2.169209 (23s)
epoch : 777, eubo : -374.523560, log\_q : 16.068613, KL : 0.813849 (28s)
epoch : 778, eubo : -294.507599, log\_q : 14.952518, KL : 2.713490 (29s)
epoch : 779, eubo : -383.127838, log\_q : 14.002309, KL : 2.177335 (26s)
epoch : 780, eubo : -290.155060, log\_q : 16.373440, KL : 2.225716 (23s)
epoch : 781, eubo : -337.171783, log\_q : 15.614827, KL : 1.494622 (27s)
epoch : 782, eubo : -379.700836, log\_q : 14.737833, KL : 4.756561 (31s)
epoch : 783, eubo : -368.925903, log\_q : 11.573009, KL : 4.577085 (33s)
epoch : 784, eubo : -292.101776, log\_q : 15.555623, KL : 1.520701 (27s)
epoch : 785, eubo : -313.383118, log\_q : 16.641706, KL : 0.933101 (30s)
epoch : 786, eubo : -265.449463, log\_q : 15.900705, KL : 3.064182 (32s)
epoch : 787, eubo : -332.028168, log\_q : 15.667246, KL : 3.064559 (30s)
epoch : 788, eubo : -539.091125, log\_q : 17.157637, KL : 5.061888 (30s)
epoch : 789, eubo : -451.345459, log\_q : 18.070173, KL : 3.218524 (38s)
epoch : 790, eubo : -353.375092, log\_q : 15.780836, KL : 2.753666 (32s)
epoch : 791, eubo : -321.026001, log\_q : 15.266732, KL : 2.053977 (25s)
epoch : 792, eubo : -316.363831, log\_q : 13.105272, KL : 1.367161 (25s)
epoch : 793, eubo : -346.829468, log\_q : 12.471736, KL : 2.403359 (23s)
epoch : 794, eubo : -345.057434, log\_q : 14.561076, KL : 3.416906 (25s)
epoch : 795, eubo : -492.088440, log\_q : 16.606379, KL : 1.318207 (25s)
epoch : 796, eubo : -571.348938, log\_q : 17.867882, KL : 3.123723 (38s)
epoch : 797, eubo : -569.720947, log\_q : 12.616475, KL : 5.085681 (25s)
epoch : 798, eubo : -297.152344, log\_q : 17.841898, KL : 1.617287 (24s)
epoch : 799, eubo : -333.915009, log\_q : 18.223440, KL : 6.034599 (38s)
epoch : 800, eubo : -373.512604, log\_q : 14.735882, KL : 1.782156 (31s)
epoch : 801, eubo : -312.830780, log\_q : 15.928421, KL : 0.880167 (30s)
epoch : 802, eubo : -362.344727, log\_q : 16.779566, KL : 0.803074 (34s)
epoch : 803, eubo : -335.628296, log\_q : 14.227369, KL : 2.896917 (27s)
epoch : 804, eubo : -351.257568, log\_q : 16.891890, KL : 3.001291 (35s)
epoch : 805, eubo : -513.302490, log\_q : 15.052487, KL : 1.668500 (31s)
epoch : 806, eubo : -351.943359, log\_q : 17.415253, KL : 4.171092 (37s)
epoch : 807, eubo : -343.078918, log\_q : 12.051537, KL : 2.146695 (27s)
epoch : 808, eubo : -415.289703, log\_q : 16.197794, KL : 1.509660 (34s)
epoch : 809, eubo : -356.649231, log\_q : 15.937063, KL : 2.086545 (33s)
epoch : 810, eubo : -328.794678, log\_q : 14.482145, KL : 2.844473 (34s)
epoch : 811, eubo : -428.296265, log\_q : 17.039600, KL : 1.880523 (36s)
epoch : 812, eubo : -475.663116, log\_q : 15.571729, KL : 2.471427 (36s)
epoch : 813, eubo : -308.330902, log\_q : 14.044408, KL : 3.616996 (25s)
epoch : 814, eubo : -264.453583, log\_q : 15.638767, KL : 1.942405 (26s)
epoch : 815, eubo : -226.654449, log\_q : 15.058061, KL : 2.215905 (27s)
epoch : 816, eubo : -302.486877, log\_q : 16.085447, KL : 2.463216 (27s)
epoch : 817, eubo : -447.497833, log\_q : 17.593021, KL : 2.571596 (36s)
epoch : 818, eubo : -468.331696, log\_q : 17.098978, KL : 2.323224 (36s)
epoch : 819, eubo : -376.732086, log\_q : 14.227349, KL : 2.531447 (25s)
epoch : 820, eubo : -475.572357, log\_q : 15.683046, KL : 4.860311 (34s)
epoch : 821, eubo : -434.902924, log\_q : 15.446379, KL : 2.346791 (37s)
epoch : 822, eubo : -463.817291, log\_q : 16.985531, KL : 1.976116 (34s)
epoch : 823, eubo : -465.647003, log\_q : 17.701578, KL : 2.757748 (28s)
epoch : 824, eubo : -414.621918, log\_q : 17.230940, KL : 0.909673 (37s)
epoch : 825, eubo : -251.683914, log\_q : 13.680996, KL : 2.771160 (25s)
epoch : 826, eubo : -357.066040, log\_q : 12.832414, KL : 2.806995 (36s)
epoch : 827, eubo : -437.333466, log\_q : 18.320353, KL : 1.449393 (35s)
epoch : 828, eubo : -357.322266, log\_q : 17.535995, KL : 4.451551 (34s)
epoch : 829, eubo : -348.469147, log\_q : 17.080160, KL : 1.501584 (32s)
epoch : 830, eubo : -343.095673, log\_q : 15.710276, KL : 2.548928 (26s)
epoch : 831, eubo : -277.788116, log\_q : 15.658390, KL : 1.449435 (33s)
epoch : 832, eubo : -347.235382, log\_q : 15.604926, KL : 1.789034 (24s)
epoch : 833, eubo : -362.947906, log\_q : 16.063316, KL : 3.217032 (26s)
epoch : 834, eubo : -347.958038, log\_q : 17.721329, KL : 1.557097 (26s)
epoch : 835, eubo : -388.593384, log\_q : 15.183662, KL : 2.028778 (32s)
epoch : 836, eubo : -239.922699, log\_q : 15.729279, KL : 4.167032 (23s)
epoch : 837, eubo : -321.798737, log\_q : 11.897397, KL : 3.138613 (25s)
epoch : 838, eubo : -413.289124, log\_q : 14.837377, KL : 2.981355 (37s)
epoch : 839, eubo : -415.419525, log\_q : 16.909777, KL : 3.756891 (35s)
epoch : 840, eubo : -433.832581, log\_q : 12.125701, KL : 2.804478 (28s)
epoch : 841, eubo : -463.459503, log\_q : 17.489660, KL : 1.269192 (36s)
epoch : 842, eubo : -346.198975, log\_q : 13.415143, KL : 2.161560 (24s)
epoch : 843, eubo : -350.972198, log\_q : 18.364973, KL : 2.273226 (32s)
epoch : 844, eubo : -466.530945, log\_q : 17.819605, KL : 2.882720 (37s)
epoch : 845, eubo : -586.257385, log\_q : 13.523394, KL : 3.081247 (25s)
epoch : 846, eubo : -381.511475, log\_q : 16.149422, KL : 4.795445 (35s)
epoch : 847, eubo : -390.024292, log\_q : 15.701601, KL : 2.013215 (29s)
epoch : 848, eubo : -389.853607, log\_q : 17.868635, KL : 3.032635 (35s)
epoch : 849, eubo : -437.279358, log\_q : 15.844654, KL : 1.429829 (28s)
epoch : 850, eubo : -336.442291, log\_q : 15.732990, KL : 1.456615 (29s)
epoch : 851, eubo : -338.240814, log\_q : 18.164492, KL : 1.571259 (38s)
epoch : 852, eubo : -387.260742, log\_q : 16.448587, KL : 1.756538 (35s)
epoch : 853, eubo : -509.557678, log\_q : 17.719908, KL : 1.755417 (37s)
epoch : 854, eubo : -567.063904, log\_q : 17.758854, KL : 4.119977 (37s)
epoch : 855, eubo : -333.518799, log\_q : 15.041785, KL : 1.410022 (30s)
epoch : 856, eubo : -427.346375, log\_q : 15.545380, KL : 2.677949 (26s)
epoch : 857, eubo : -407.844299, log\_q : 16.783955, KL : 2.504696 (35s)
epoch : 858, eubo : -327.935455, log\_q : 15.341707, KL : 4.250754 (33s)
epoch : 859, eubo : -413.757874, log\_q : 17.827162, KL : 1.637005 (34s)
epoch : 860, eubo : -332.689240, log\_q : 15.762369, KL : 1.264100 (33s)
epoch : 861, eubo : -304.972168, log\_q : 12.798747, KL : 2.752833 (26s)
epoch : 862, eubo : -524.350342, log\_q : 17.705406, KL : 4.048887 (34s)
epoch : 863, eubo : -211.514572, log\_q : 17.225813, KL : 4.388178 (23s)
epoch : 864, eubo : -341.466339, log\_q : 15.150363, KL : 1.655085 (24s)
epoch : 865, eubo : -394.408875, log\_q : 16.598972, KL : 2.837420 (32s)
epoch : 866, eubo : -531.367065, log\_q : 16.693970, KL : 1.918271 (33s)
epoch : 867, eubo : -375.742767, log\_q : 17.304050, KL : 1.566293 (30s)
epoch : 868, eubo : -480.877838, log\_q : 13.809687, KL : 2.161341 (27s)
epoch : 869, eubo : -270.959167, log\_q : 15.703919, KL : 3.637955 (27s)
epoch : 870, eubo : -227.043625, log\_q : 17.752533, KL : 1.930215 (26s)
epoch : 871, eubo : -268.050140, log\_q : 14.043392, KL : 4.445603 (31s)
epoch : 872, eubo : -304.019592, log\_q : 15.789029, KL : 1.651717 (29s)
epoch : 873, eubo : -357.991669, log\_q : 16.017422, KL : 1.679094 (29s)
epoch : 874, eubo : -465.259918, log\_q : 16.225622, KL : 1.930450 (27s)
epoch : 875, eubo : -326.004639, log\_q : 17.612324, KL : 2.605475 (25s)
epoch : 876, eubo : -660.849121, log\_q : 16.854393, KL : 2.743801 (33s)
epoch : 877, eubo : -300.947327, log\_q : 17.211699, KL : 1.499974 (23s)
epoch : 878, eubo : -223.593079, log\_q : 17.725887, KL : 2.852880 (24s)
epoch : 879, eubo : -398.108429, log\_q : 16.858341, KL : 1.408797 (31s)
epoch : 880, eubo : -480.852386, log\_q : 14.004498, KL : 1.751265 (32s)
epoch : 881, eubo : -352.790527, log\_q : 16.188053, KL : 1.994966 (25s)
epoch : 882, eubo : -290.142395, log\_q : 17.568241, KL : 2.636604 (30s)
epoch : 883, eubo : -447.423798, log\_q : 15.167361, KL : 3.343782 (32s)
epoch : 884, eubo : -423.127563, log\_q : 16.844961, KL : 2.524132 (36s)
epoch : 885, eubo : -491.909271, log\_q : 18.330278, KL : 2.461175 (37s)
epoch : 886, eubo : -328.705505, log\_q : 15.366969, KL : 2.838542 (30s)
epoch : 887, eubo : -287.399750, log\_q : 14.666879, KL : 2.358711 (35s)
epoch : 888, eubo : -297.622101, log\_q : 17.922728, KL : 3.266830 (33s)
epoch : 889, eubo : -503.841187, log\_q : 16.943480, KL : 1.847494 (34s)
epoch : 890, eubo : -299.536560, log\_q : 16.080353, KL : 2.326995 (24s)
epoch : 891, eubo : -446.593018, log\_q : 17.054008, KL : 1.314674 (31s)
epoch : 892, eubo : -587.210022, log\_q : 16.441195, KL : 2.054811 (28s)
epoch : 893, eubo : -374.320862, log\_q : 13.683784, KL : 3.624558 (29s)
epoch : 894, eubo : -312.959106, log\_q : 17.878151, KL : 3.315194 (26s)
epoch : 895, eubo : -512.213989, log\_q : 17.692898, KL : 1.112446 (35s)
epoch : 896, eubo : -380.673828, log\_q : 16.895065, KL : 1.980505 (29s)
epoch : 897, eubo : -339.859650, log\_q : 15.339194, KL : 3.140407 (29s)
epoch : 898, eubo : -442.187317, log\_q : 14.947939, KL : 3.056819 (30s)
epoch : 899, eubo : -417.460236, log\_q : 18.341007, KL : 1.943083 (34s)
epoch : 900, eubo : -443.759277, log\_q : 17.588278, KL : 0.865404 (36s)
epoch : 901, eubo : -494.827301, log\_q : 17.770300, KL : 3.457816 (37s)
epoch : 902, eubo : -331.113129, log\_q : 14.937122, KL : 1.728387 (23s)
epoch : 903, eubo : -468.198456, log\_q : 17.053076, KL : 3.259871 (35s)
epoch : 904, eubo : -427.339264, log\_q : 16.452738, KL : 2.230002 (27s)
epoch : 905, eubo : -378.734955, log\_q : 14.241666, KL : 5.476193 (36s)
epoch : 906, eubo : -359.820068, log\_q : 15.629947, KL : 1.385634 (28s)
epoch : 907, eubo : -456.314758, log\_q : 15.231732, KL : 3.006967 (36s)
epoch : 908, eubo : -446.650848, log\_q : 18.480734, KL : 1.745944 (37s)
epoch : 909, eubo : -354.964142, log\_q : 17.810272, KL : 3.472868 (30s)
epoch : 910, eubo : -339.736603, log\_q : 16.416620, KL : 2.509066 (31s)
epoch : 911, eubo : -263.760162, log\_q : 15.793459, KL : 1.751114 (23s)
epoch : 912, eubo : -319.885406, log\_q : 16.116318, KL : 2.128749 (28s)
epoch : 913, eubo : -354.702393, log\_q : 15.035378, KL : 0.877572 (27s)
epoch : 914, eubo : -267.331116, log\_q : 14.368636, KL : 1.188375 (24s)
epoch : 915, eubo : -385.040161, log\_q : 16.774162, KL : 2.624838 (30s)
epoch : 916, eubo : -603.654785, log\_q : 17.175888, KL : 4.325346 (34s)
epoch : 917, eubo : -310.340179, log\_q : 14.674868, KL : 1.014754 (25s)
epoch : 918, eubo : -347.103241, log\_q : 14.926704, KL : 3.793732 (35s)
epoch : 919, eubo : -312.686218, log\_q : 15.993855, KL : 1.571625 (27s)
epoch : 920, eubo : -387.634613, log\_q : 16.296846, KL : 4.932078 (35s)
epoch : 921, eubo : -275.219971, log\_q : 14.290900, KL : 1.844364 (24s)
epoch : 922, eubo : -436.604614, log\_q : 15.154006, KL : 7.360921 (30s)
epoch : 923, eubo : -424.326477, log\_q : 17.911097, KL : 2.191039 (34s)
epoch : 924, eubo : -313.235077, log\_q : 15.512589, KL : 4.120640 (24s)
epoch : 925, eubo : -306.562805, log\_q : 15.344483, KL : 1.420545 (23s)
epoch : 926, eubo : -437.352081, log\_q : 9.690130, KL : 1.957235 (23s)
epoch : 927, eubo : -369.514130, log\_q : 17.136332, KL : 1.909732 (31s)
epoch : 928, eubo : -370.177612, log\_q : 15.715036, KL : 1.265987 (24s)
epoch : 929, eubo : -355.054474, log\_q : 16.030294, KL : 3.744948 (28s)
epoch : 930, eubo : -504.562927, log\_q : 15.831491, KL : 3.159595 (30s)
epoch : 931, eubo : -495.824860, log\_q : 16.288414, KL : 2.310949 (34s)
epoch : 932, eubo : -392.262421, log\_q : 18.299404, KL : 3.203630 (32s)
epoch : 933, eubo : -363.178925, log\_q : 14.804144, KL : 1.822351 (23s)
epoch : 934, eubo : -383.739532, log\_q : 16.234781, KL : 1.423508 (23s)
epoch : 935, eubo : -484.827484, log\_q : 16.108978, KL : 1.659361 (30s)
epoch : 936, eubo : -369.329865, log\_q : 16.257296, KL : 5.746099 (37s)
epoch : 937, eubo : -375.151550, log\_q : 16.753571, KL : 2.667128 (35s)
epoch : 938, eubo : -518.147156, log\_q : 17.016735, KL : 2.506202 (38s)
epoch : 939, eubo : -603.074890, log\_q : 11.491561, KL : 3.860487 (25s)
epoch : 940, eubo : -350.156586, log\_q : 13.139985, KL : 6.559889 (35s)
epoch : 941, eubo : -505.565704, log\_q : 16.581276, KL : 1.843852 (28s)
epoch : 942, eubo : -406.636444, log\_q : 15.138309, KL : 5.448326 (33s)
epoch : 943, eubo : -426.618195, log\_q : 17.358711, KL : 2.360040 (36s)
epoch : 944, eubo : -471.734283, log\_q : 16.085159, KL : 3.760141 (29s)
epoch : 945, eubo : -411.450195, log\_q : 15.869716, KL : 3.808213 (29s)
epoch : 946, eubo : -337.147705, log\_q : 12.871397, KL : 1.868931 (25s)
epoch : 947, eubo : -350.103607, log\_q : 15.939133, KL : 2.258814 (28s)
epoch : 948, eubo : -435.061920, log\_q : 13.943754, KL : 3.255653 (34s)
epoch : 949, eubo : -564.840881, log\_q : 15.702773, KL : 5.224736 (31s)
epoch : 950, eubo : -383.230103, log\_q : 16.240576, KL : 1.879317 (26s)
epoch : 951, eubo : -343.107269, log\_q : 15.342173, KL : 1.525757 (23s)
epoch : 952, eubo : -313.159882, log\_q : 15.840720, KL : 1.299500 (27s)
epoch : 953, eubo : -284.705566, log\_q : 15.790378, KL : 3.275107 (28s)
epoch : 954, eubo : -341.333160, log\_q : 16.806644, KL : 1.936480 (25s)
epoch : 955, eubo : -345.180634, log\_q : 16.240496, KL : 1.843340 (24s)
epoch : 956, eubo : -327.841125, log\_q : 15.237476, KL : 2.200931 (31s)
epoch : 957, eubo : -348.536865, log\_q : 16.291424, KL : 2.424685 (32s)
epoch : 958, eubo : -357.104584, log\_q : 16.344921, KL : 1.262693 (26s)
epoch : 959, eubo : -354.380188, log\_q : 16.244097, KL : 1.691160 (30s)
epoch : 960, eubo : -361.648132, log\_q : 17.234848, KL : 2.048355 (37s)
epoch : 961, eubo : -289.685120, log\_q : 15.734892, KL : 1.808229 (27s)
epoch : 962, eubo : -511.917755, log\_q : 16.844866, KL : 3.980769 (34s)
epoch : 963, eubo : -402.713074, log\_q : 15.973481, KL : 1.118691 (35s)
epoch : 964, eubo : -461.879883, log\_q : 17.937275, KL : 2.064682 (36s)
epoch : 965, eubo : -341.221527, log\_q : 14.529477, KL : 1.370824 (26s)
epoch : 966, eubo : -478.975250, log\_q : 15.890200, KL : 1.351450 (37s)
epoch : 967, eubo : -301.928223, log\_q : 12.671405, KL : 3.156846 (24s)
epoch : 968, eubo : -440.305878, log\_q : 15.668206, KL : 6.524969 (37s)
epoch : 969, eubo : -353.192383, log\_q : 18.050537, KL : 2.073831 (28s)
epoch : 970, eubo : -301.065186, log\_q : 14.103211, KL : 1.390929 (27s)
epoch : 971, eubo : -383.222046, log\_q : 17.108688, KL : 1.337994 (30s)
epoch : 972, eubo : -339.849487, log\_q : 16.913414, KL : 2.902073 (27s)
epoch : 973, eubo : -399.800476, log\_q : 17.311178, KL : 4.560689 (27s)
epoch : 974, eubo : -413.177551, log\_q : 12.815663, KL : 4.599491 (34s)
epoch : 975, eubo : -335.944000, log\_q : 16.661396, KL : 1.660197 (34s)
epoch : 976, eubo : -331.204071, log\_q : 16.611116, KL : 1.009987 (31s)
epoch : 977, eubo : -311.903717, log\_q : 14.081791, KL : 2.021204 (26s)
epoch : 978, eubo : -342.681580, log\_q : 14.708122, KL : 1.965761 (23s)
epoch : 979, eubo : -342.605469, log\_q : 16.034595, KL : 0.904815 (30s)
epoch : 980, eubo : -273.696564, log\_q : 13.179556, KL : 3.086277 (24s)
epoch : 981, eubo : -434.735840, log\_q : 15.564661, KL : 3.579566 (38s)
epoch : 982, eubo : -321.413574, log\_q : 15.440416, KL : 1.736876 (34s)
epoch : 983, eubo : -421.577972, log\_q : 16.162859, KL : 2.022236 (31s)
epoch : 984, eubo : -485.292084, log\_q : 16.648571, KL : 2.570235 (27s)
epoch : 985, eubo : -348.501434, log\_q : 15.725720, KL : 2.504359 (29s)
epoch : 986, eubo : -316.417145, log\_q : 13.904568, KL : 3.242780 (24s)
epoch : 987, eubo : -532.854248, log\_q : 16.779560, KL : 1.755286 (32s)
epoch : 988, eubo : -363.749084, log\_q : 14.398317, KL : 2.034315 (25s)
epoch : 989, eubo : -207.921997, log\_q : 13.149144, KL : 2.066127 (23s)
epoch : 990, eubo : -285.777710, log\_q : 14.906237, KL : 0.967129 (24s)
epoch : 991, eubo : -412.231476, log\_q : 16.333508, KL : 1.564992 (26s)
epoch : 992, eubo : -416.728302, log\_q : 15.748775, KL : 3.608016 (30s)
epoch : 993, eubo : -398.247925, log\_q : 16.510393, KL : 1.781402 (32s)
epoch : 994, eubo : -779.036072, log\_q : 15.602806, KL : 7.316904 (37s)
epoch : 995, eubo : -361.434418, log\_q : 15.552415, KL : 1.327156 (31s)
epoch : 996, eubo : -412.987122, log\_q : 17.712744, KL : 1.583230 (33s)
epoch : 997, eubo : -361.763519, log\_q : 17.258831, KL : 1.023029 (30s)
epoch : 998, eubo : -311.611115, log\_q : 15.134283, KL : 3.423540 (29s)
epoch : 999, eubo : -450.766479, log\_q : 17.120777, KL : 1.383532 (38s)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{learned\PYZus{}dicichlet\PYZus{}post} \PY{o}{=} \PY{n}{latents\PYZus{}dirs}
        \PY{n}{true\PYZus{}dirichlet\PYZus{}post} \PY{o}{=} \PY{n}{alpha\PYZus{}trans\PYZus{}0} \PY{o}{+} \PY{n}{pairwise}\PY{p}{(}\PY{n}{torch}\PY{o}{.}\PY{n}{from\PYZus{}numpy}\PY{p}{(}\PY{n}{Zs\PYZus{}true}\PY{p}{)}\PY{o}{.}\PY{n}{float}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{T}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{variational : }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{learned\PYZus{}dicichlet\PYZus{}post}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{conjugate posterior :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{true\PYZus{}dirichlet\PYZus{}post}\PY{p}{)}
        \PY{n}{plot\PYZus{}dirs}\PY{p}{(}\PY{n}{learned\PYZus{}dicichlet\PYZus{}post}\PY{o}{.}\PY{n}{data}\PY{o}{.}\PY{n}{numpy}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{true\PYZus{}dirichlet\PYZus{}post}\PY{o}{.}\PY{n}{data}\PY{o}{.}\PY{n}{numpy}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{vmax}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
variational : 
tensor([[ 9.8174,  1.5788,  1.1719,  2.1971],
        [ 1.6996, 12.0402,  2.2865,  1.2166],
        [ 1.1827,  2.6430, 11.2216,  1.9063],
        [ 1.9016,  1.4460,  1.4887, 11.7790]], grad\_fn=<ViewBackward>)
conjugate posterior :
tensor([[11.,  2.,  1.,  2.],
        [ 1., 14.,  3.,  1.],
        [ 2.,  2., 12.,  2.],
        [ 2.,  1.,  2., 18.]])

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_7_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{ESSs}\PY{p}{)} \PY{o}{/} \PY{n}{num\PYZus{}particles\PYZus{}rws}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}9}]:} [<matplotlib.lines.Line2D at 0x7f49f0f41c18>]
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_8_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{learned\PYZus{}dicichlet\PYZus{}post}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}10}]:} tensor(65.5771, grad\_fn=<SumBackward0>)
\end{Verbatim}
            

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
